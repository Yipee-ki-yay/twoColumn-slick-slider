"use strict";var PopupModule,RecentFunctions,ValidationModule,AccordionModule,AnimateBorder,popupOrder,modals,pageOverlay,status="JS - OK!";function cl(e,o,t,n){return console.log(e,o||"",t||"",n||""),"-"}cl(status);var test="include js error";$(document).ready(function(){console.log("document ready"),popupOrder=document.getElementById("popupOrder"),modals=document.getElementsByClassName("popup"),pageOverlay=document.getElementById("pageOverlay"),test="include js - OK",$("body")&&console.log("jQuery OK"),console.log(test),$("body").on("click",".orderButton",function(){popupOrder&&PopupModule.openPopup(popupOrder)}),$("accordionBlockSelector").on("click",".buttonSelector",function(e){if(document.documentElement.clientWidth<992){e.stopPropagation();var o=this.nextElementSibling;toggleButtonContent(this),AccordionModule.toggleContent("withoutSiblings",this,o)}}),window.innerWidth<768&&$(".main-slider-mobile").length&&$(".main-slider-mobile").slick({arrows:!1,dots:!0,vertical:!0}),768<=window.innerWidth&&function(){if($(".main-slider-desctop").length){var e=$(".main-slider-desctop"),n=0;e.slick({arrows:!1,dots:!0,fade:!0,speed:900,autoplay:!0,autoplaySpeed:4e3}),setTimeout(function(){e.find(".slider-desctop-item:first-child").addClass("animated")},10),e.on("beforeChange",function(e,o,t){$(o.$slides[t]).removeClass("animated")}),e.on("afterChange",function(e,o,t){$(o.$slides[t]).addClass("animated"),++n==o.$slides.length&&$(this).slick("slickSetOption","autoplay",!1)})}}()}),window.onload=function(){console.log("window load")};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInN0YXR1cyIsIlJlY2VudEZ1bmN0aW9ucyIsIlZhbGlkYXRpb25Nb2R1bGUiLCJBY2NvcmRpb25Nb2R1bGUiLCJQb3B1cE1vZHVsZSIsIkFuaW1hdGVCb3JkZXIiLCJtb2RhbHMiLCJwYWdlT3ZlcmxheSIsImNsIiwiYXJnMSIsImFyZzIiLCJhcmczIiwiYXJnNCIsImNvbnNvbGUiLCJ0ZXN0IiwiJCIsImRvY3VtZW50IiwicmVhZHkiLCJnZXRFbGVtZW50QnlJZCIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJsb2ciLCJvbiIsIm9wZW5Qb3B1cCIsInBvcHVwT3JkZXIiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwiY2xpZW50V2lkdGgiLCJidXR0b24iLCJ0aGlzIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwidG9nZ2xlQ29udGVudCIsInN1Ym1lbnVCbG9jayIsIndpbmRvdyIsImlubmVyV2lkdGgiLCJhcnJvd3MiLCJsZW5ndGgiLCJ2ZXJ0aWNhbCIsInNsaWNrIiwiZG90cyIsImNvdW50ZXIiLCIkc2xpZGVyRGVzY3RvcCIsImZhZGUiLCJzcGVlZCIsImF1dG9wbGF5IiwiYXV0b3BsYXlTcGVlZCIsInNldFRpbWVvdXQiLCJhZGRDbGFzcyIsImN1cnJlbnRTbGlkZSIsImV2ZW50IiwicmVtb3ZlQ2xhc3MiLCJvbmxvYWQiXSwibWFwcGluZ3MiOiJhQUFBLElBTUdBLFlBQUhDLGdCQUFBQyxpQkFHSUMsZ0JBREFDLGNBRUFDLFdBR0ZDLE9BQVFDLFlBYk5QLE9BQVMsV0FDYixTQUFTUSxHQUFHQyxFQUFNQyxFQUFNQyxFQUFNQyxHQUE5QixPQURBQyxRQUFJYixJQUFTUyxFQUFBQyxHQUFiLEdBQUFDLEdBQUEsR0FBQUMsR0FBQSxJQUNBLElBR0NKLEdBQUFSLFFBV0QsSUFBSWMsS0FBTyxtQkFFWEMsRUFBRUMsVUFBVUMsTUFBTSxXQUFsQkYsUUFBRUMsSUFBVUMsa0JBQ1hKLFdBQVlHLFNBQUFFLGVBQVosY0FHQVosT0FBU1UsU0FBU0csdUJBQXVCLFNBQXpDYixZQUFTVSxTQUFTRyxlQUFBQSxlQU1sQkwsS0FBTyxrQkE0N0JrQ0MsRUFBQSxTQUFBRixRQUFBTyxJQUFBLGFBQ3pDUCxRQUFRTyxJQUFJTixNQU1WQyxFQUFBLFFBQUFNLEdBQUEsUUFBQSxlQUFBLFdBRUNqQixZQUNBQSxZQUFBa0IsVUFBQUMsY0FLRlIsRUFBQSwwQkFBQU0sR0FBQSxRQUFBLGtCQUFBLFNBQUFHLEdBR0NBLEdBQUVDLFNBQUFBLGdCQUFGQyxZQUFBLElBQUEsQ0FDQUYsRUFBQUMsa0JBQ0EsSUFBSUUsRUFBSkMsS0FBQUMsbUJBS0ExQixvQkFMYXlCLE1BTWJ6QixnQkFBQTJCLGNBQUEsa0JBTmFGLEtBTWJHLE1BZ0NFQyxPQUFPQyxXQUFhLEtBS3JCQyxFQUFBQSx1QkFEOEJDLFFBRzlCQyxFQUFBQSx1QkFBVUMsTUFBQSxDQUhYSCxRQUFBLEVBSERJLE1BQUEsRUFTQUYsVUFBQSxJQUV3QixLQUFyQkosT0FBT0MsWUFJVCxXQUNBLEdBQUlNLEVBQUFBLHdCQUFKSixPQUFBLENBRUFLLElBQUFBLEVBQXFCekIsRUFBQSx3QkFDcEJtQixFQURvQixFQUdwQk8sRUFIb0JKLE1BQUEsQ0FJcEJLLFFBQU8sRUFDUEMsTUFBQUEsRUFDRUMsTUFBQUEsRUFOSEYsTUFBQSxJQUtDQyxVQUFVLEVBSVhFLGNBQVcsTUFBWEEsV0FBVyxXQUlYTCxFQUFlbkIsS0FBRyxvQ0FBZ0J5QixTQUF1QkMsYUFDdERWLElBREhHLEVBQWVuQixHQUFHLGVBQWdCLFNBQVMyQixFQUFPWCxFQUFPVSxHQUl6RFAsRUFBQUEsRUFBQUEsUUFBa0JPLElBQWVFLFlBQVNELGNBR3pDVCxFQUFBQSxHQUFBQSxjQUFBQSxTQUFBQSxFQUFBQSxFQUFBQSxHQUNBeEIsRUFBQXNCLEVBQUEsUUFBY0EsSUFBaUJGLFNBQVEsY0FFdENJLEdBTkZGLEVBQUEsUUFBQUYsUUF2QkRwQixFQUFBYSxNQUFBUyxNQUFBLGlCQUFBLFlBQUEsTUFHQyxLQW9DSEwsT0FBT2tCLE9BQVMsV0FDZnJDLFFBQVFPLElBQUkiLCJmaWxlIjoiaW5kZXgubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHN0YXR1cyA9IFwiSlMgLSBPSyFcIjtcclxuZnVuY3Rpb24gY2woYXJnMSwgYXJnMiwgYXJnMywgYXJnNCkge1xyXG5cdGNvbnNvbGUubG9nKGFyZzEsIGFyZzIgfHwgJycsIGFyZzMgfHwgJycsIGFyZzQgfHwgJycpO1xyXG5cdHJldHVybiAnLSc7XHJcbn1cclxuXHJcbmNsKHN0YXR1cyk7XHJcblxyXG52YXIgUG9wdXBNb2R1bGUsIFJlY2VudEZ1bmN0aW9ucywgVmFsaWRhdGlvbk1vZHVsZTtcclxudmFyIEFjY29yZGlvbk1vZHVsZTtcclxudmFyIEFuaW1hdGVCb3JkZXI7XHJcblxyXG52YXIgcG9wdXBPcmRlcixcclxuXHRcdG1vZGFscywgcGFnZU92ZXJsYXk7XHJcblxyXG52YXIgdGVzdCA9ICdpbmNsdWRlIGpzIGVycm9yJztcclxuXHJcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xyXG5cdGNvbnNvbGUubG9nKCdkb2N1bWVudCByZWFkeScpXHJcblx0cG9wdXBPcmRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cE9yZGVyJyk7XHJcblx0XHJcblx0bW9kYWxzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncG9wdXAnKTtcclxuXHRwYWdlT3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWdlT3ZlcmxheScpO1xyXG5cclxuXHJcblx0Ly8gPT09PT09PT09PT09PT09PT1JbmNsdWRlIE1vZHVsZXM9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcblx0dGVzdCA9ICdpbmNsdWRlIGpzIC0gT0snO1xyXG5cclxuXHJcblx0LypSZWNlbnRGdW5jdGlvbnMgPSAoZnVuY3Rpb24gKCkge1xyXG5cclxuICBmdW5jdGlvbiByZXR1cm5ET00oZWxlbWVudCkge1xyXG4gICAgcmV0dXJuIGVsZW1lbnQgaW5zdGFuY2VvZiBqUXVlcnkgPyBlbGVtZW50WzBdIDogZWxlbWVudDtcclxuICB9XHJcblxyXG5cdGZ1bmN0aW9uIGdldEN1cnJlbnRZUG9zaXRpb24oKSB7XHJcblx0ICByZXR1cm4gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBhZGRDbGFzc1RvKGVsZW1lbnQsIGFjdGl2ZUNsYXNzKSB7XHJcbiAgICB2YXIgZWxlbSA9IHJldHVybkRPTShlbGVtZW50KTtcclxuXHRcdGlmICghZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoYWN0aXZlQ2xhc3MpKSB7XHJcblx0XHRcdGVsZW0uY2xhc3NMaXN0LmFkZChhY3RpdmVDbGFzcyk7XHJcblx0XHR9XHJcblx0fVxyXG5cdGZ1bmN0aW9uIHJlbW92ZUNsYXNzRnJvbShlbGVtZW50LCBhY3RpdmVDbGFzcykge1xyXG4gICAgdmFyIGVsZW0gPSByZXR1cm5ET00oZWxlbWVudCk7XHJcblx0XHRpZiAoZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoYWN0aXZlQ2xhc3MpKSB7XHJcblx0XHRcdGVsZW0uY2xhc3NMaXN0LnJlbW92ZShhY3RpdmVDbGFzcyk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiB0cmFuc2l0aW9uSGFuZGxlcihldmVudCwgdGFyZ2V0QmxvY2ssIGhpZGRlbkNvbnRlbnQpIHtcclxuXHRcdGlmIChldmVudC5wcm9wZXJ0eU5hbWUpIHtcclxuXHRcdFx0Y29uc29sZS5sb2coZXZlbnQucHJvcGVydHlOYW1lKSAgLy8geW91ciBjb2RlIGhlcmVcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoZXZlbnQuc3JjRWxlbWVudCkge1xyXG5cdFx0XHRjb25zb2xlLmxvZyhldmVudC5zcmNFbGVtZW50KSAgLy8geW91ciBjb2RlIGhlcmVcclxuXHRcdH1cclxuXHR9XHJcblxyXG4gXHRmdW5jdGlvbiBnZXRDaGlsZHNUb3RhbFdpZHRoKHBhcmVudCkge1xyXG4gXHRcdGxldCBjaGlsZHJlbiA9IHBhcmVudC5jaGlsZHJlbjtcclxuIFx0XHRsZXQgcmVzdWx0ID0gMDtcclxuXHJcbiBcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gXHRcdFx0cmVzdWx0ID0gcmVzdWx0ICsgY2hpbGRyZW5baV0ub2Zmc2V0V2lkdGg7XHJcbiBcdFx0fVxyXG4gXHRcdHJldHVybiByZXN1bHQ7XHJcbiBcdH1cclxuXHJcbiBcdGZ1bmN0aW9uIGdldENvb3Jkc09uUGFnZShlbGVtZW50KSB7IFxyXG4gXHRcdHZhciBlbGVtID0gcmV0dXJuRE9NKGVsZW1lbnQpO1xyXG4gXHRcdHZhciBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG5cclxuIFx0XHRyZXR1cm4ge1xyXG4gXHRcdFx0dG9wOiBib3gudG9wICsgcGFnZVlPZmZzZXQsXHJcbiBcdFx0XHRsZWZ0OiBib3gubGVmdCArIHBhZ2VYT2Zmc2V0LFxyXG4gXHRcdFx0Ym90dG9tOiBib3guYm90dG9tICsgcGFnZVlPZmZzZXRcclxuIFx0XHR9O1xyXG4gXHR9XHJcblxyXG4gXHRmdW5jdGlvbiBnZXRDb29yZHNPblNjcmVlbihlbGVtZW50KSB7XHJcbiBcdFx0dmFyIGVsZW0gPSByZXR1cm5ET00oZWxlbWVudCk7XHJcbiBcdFx0dmFyIGJveCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcbiAgXHQvLyBjb25zb2xlLmxvZyhib3gpXHJcblxyXG4gIFx0cmV0dXJuIHtcclxuICBcdFx0dG9wOiBib3gudG9wLFxyXG4gIFx0XHRsZWZ0OiBib3gubGVmdCxcclxuICBcdFx0Ym90dG9tOiBib3guYm90dG9tLFxyXG4gIFx0XHRyaWdodDogYm94LnJpZ2h0LFxyXG4gIFx0XHR3aWR0aDogYm94LndpZHRoLFxyXG4gIFx0XHRoZWlnaHQ6IGJveC5oZWlnaHQsXHJcbiAgXHR9O1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gb3BlbldpZHRoKGVsZW1lbnQpIHtcclxuICBcdGVsZW1lbnQuc3R5bGUud2lkdGggPSBnZXRDaGlsZHNUb3RhbFdpZHRoKGVsZW1lbnQpICsgJ3B4JztcclxuICB9XHJcbiAgZnVuY3Rpb24gY29sbGFwc2VXaWR0aChlbGVtZW50KSB7XHJcbiAgXHRlbGVtZW50LnN0eWxlLndpZHRoID0gJzAnO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaXNWaXNpYmxlKHRhZywgb3B0aW9uKSB7XHJcbiAgXHRsZXQgb3B0O1xyXG4gIFx0b3B0aW9uID8gb3B0ID0gb3B0aW9uIDogb3B0ID0gXCJ3aG9sZVwiO1xyXG4gIFx0dmFyIHQgPSAkKHRhZyk7XHJcbiAgXHR2YXIgdyA9ICQod2luZG93KTtcclxuICBcdHZhciB3dCA9IHcuc2Nyb2xsVG9wKCk7XHJcbiAgXHR2YXIgdHQgPSB0Lm9mZnNldCgpLnRvcDtcclxuICBcdHZhciB0YiA9IHR0ICsgdC5oZWlnaHQoKTtcclxuXHJcbiAgXHRpZiAob3B0ID09IFwid2hvbGVcIikge1xyXG4gIFx0XHRpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoID4gOTkxKSB7XHJcbiAgXHRcdFx0cmV0dXJuICh0YiA8PSB3dCArIHcuaGVpZ2h0KCkpICYmICh0dCA+PSB3dCk7XHJcbiAgXHRcdH0gZWxzZSB7XHJcbiAgXHRcdFx0cmV0dXJuICggdHQgPD0gKHd0ICsgdy5oZWlnaHQoKSAvIDIpICkgJiYgKHR0ID49IHd0KTtcclxuICBcdFx0fVxyXG4gIFx0fVxyXG5cclxuICBcdGlmIChvcHQgPT0gXCJ0b3BCb3JkZXJcIikge1xyXG4gIFx0XHRyZXR1cm4gdHQgPD0gd3QgKyB3LmhlaWdodCgpIC0gODk7XHJcbiAgXHR9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBpc1Zpc2libGVPblhBeGlzKGVsZW1lbnQsIHBhcmVudCkge1xyXG4gICAgbGV0IGlzVmlzaWJsZU9uTGVmdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCA+IHBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0O1xyXG4gICAgbGV0IGlzVmlzaWJsZU9uUmlnaHQgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0IDwgcGFyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0O1xyXG4gICAgcmV0dXJuIGlzVmlzaWJsZU9uTGVmdCAmJiBpc1Zpc2libGVPblJpZ2h0O1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaXNMYXN0Q2hpbGQoZWxlbWVudCkge1xyXG4gICAgcmV0dXJuIGVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nID8gZmFsc2UgOiB0cnVlO1xyXG4gIH1cclxuICBmdW5jdGlvbiBpc0ZpcnN0Q2hpbGQoZWxlbWVudCkge1xyXG4gICAgcmV0dXJuIGVsZW1lbnQucHJldmlvdXNFbGVtZW50U2libGluZyA/IGZhbHNlIDogdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLVxyXG4gIHJldHVybiB7XHJcbiAgICByZXR1cm5ET006IHJldHVybkRPTSxcclxuICBcdGdldEN1cnJlbnRZUG9zaXRpb246IGdldEN1cnJlbnRZUG9zaXRpb24sXHJcbiAgXHRhZGRDbGFzc1RvOiBhZGRDbGFzc1RvLFxyXG4gIFx0cmVtb3ZlQ2xhc3NGcm9tOiByZW1vdmVDbGFzc0Zyb20sXHJcbiAgXHR0cmFuc2l0aW9uSGFuZGxlcjogdHJhbnNpdGlvbkhhbmRsZXIsXHJcbiAgXHRnZXRDaGlsZHNUb3RhbFdpZHRoOiBnZXRDaGlsZHNUb3RhbFdpZHRoLFxyXG4gIFx0Z2V0Q29vcmRzT25QYWdlOiBnZXRDb29yZHNPblBhZ2UsXHJcbiAgXHRnZXRDb29yZHNPblNjcmVlbjogZ2V0Q29vcmRzT25TY3JlZW4sXHJcbiAgXHRvcGVuV2lkdGg6IG9wZW5XaWR0aCxcclxuICBcdGNvbGxhcHNlV2lkdGg6IGNvbGxhcHNlV2lkdGgsXHJcbiAgXHRpc1Zpc2libGU6IGlzVmlzaWJsZSxcclxuICAgIGlzVmlzaWJsZU9uWEF4aXM6IGlzVmlzaWJsZU9uWEF4aXMsXHJcbiAgICBpc0xhc3RDaGlsZDogaXNMYXN0Q2hpbGQsXHJcbiAgICBpc0ZpcnN0Q2hpbGQ6IGlzRmlyc3RDaGlsZCxcclxuICB9XHJcbiAgXHJcbn0pKCkqL1xyXG5cdC8qZnVuY3Rpb24gdG9nZ2xlQnV0dG9uQ29udGVudChidXR0b25FbGVtZW50LCB0ZXh0KSB7XHJcblx0XHRsZXQgYnV0dG9uQWN0aXZlID0gYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpO1xyXG5cclxuXHRcdGlmIChidXR0b25BY3RpdmUpIHtcclxuXHRcdFx0dGV4dCA/IGJ1dHRvbkVsZW1lbnQuZmlyc3RFbGVtZW50Q2hpbGQuaW5uZXJIVE1MID0gdGV4dC5kZWZhdWx0IDogbnVsbDtcclxuXHRcdFx0YnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuXHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0ZXh0ID8gYnV0dG9uRWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZC5pbm5lckhUTUwgPSB0ZXh0LmFjdGl2ZSA6IG51bGw7XHJcblx0XHRcdGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcblx0XHR9XHJcblx0fSovXHJcblx0LyovLyBqUXVlcnkoJzxkaXYgY2xhc3M9XCJxdWFudGl0eS1uYXZcIj48ZGl2IGNsYXNzPVwicXVhbnRpdHktYnV0dG9uIHF1YW50aXR5LXVwXCI+PC9kaXY+PGRpdiBjbGFzcz1cInF1YW50aXR5LWJ1dHRvbiBxdWFudGl0eS1kb3duXCI+PC9kaXY+PC9kaXY+JykuaW5zZXJ0QWZ0ZXIoJy5xdWFudGl0eSBpbnB1dCcpO1xyXG5qUXVlcnkoJy5jdXN0b20tcXVhbnRpdHknKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG4gIHZhciBzcGlubmVyID0galF1ZXJ5KHRoaXMpLFxyXG4gIGlucHV0ID0gc3Bpbm5lci5maW5kKCdpbnB1dFt0eXBlPVwibnVtYmVyXCJdJyksXHJcbiAgYnRuVXAgPSBzcGlubmVyLmZpbmQoJy5xdWFudGl0eS11cCcpLFxyXG4gIGJ0bkRvd24gPSBzcGlubmVyLmZpbmQoJy5xdWFudGl0eS1kb3duJyksXHJcbiAgbWluID0gaW5wdXQuYXR0cignbWluJyksXHJcbiAgbWF4ID0gaW5wdXQuYXR0cignbWF4Jyk7XHJcblxyXG4gIGJ0blVwLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIHZhciBvbGRWYWx1ZSA9IHBhcnNlRmxvYXQoaW5wdXQudmFsKCkpO1xyXG4gICAgaWYgKG9sZFZhbHVlID49IG1heCkge1xyXG4gICAgICAgIHZhciBuZXdWYWwgPSBvbGRWYWx1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdmFyIG5ld1ZhbCA9IG9sZFZhbHVlICsgMTtcclxuICAgIH1cclxuXHJcbiAgICBzcGlubmVyLmZpbmQoXCJpbnB1dFwiKS52YWwobmV3VmFsKTtcclxuXHJcbiAgICBzcGlubmVyLmZpbmQoXCJpbnB1dFwiKS50cmlnZ2VyKFwiY2hhbmdlXCIpO1xyXG5cclxuICB9KTtcclxuXHJcbiAgYnRuRG93bi5jbGljayhmdW5jdGlvbigpIHtcclxuXHJcbiAgICB2YXIgb2xkVmFsdWUgPSBwYXJzZUZsb2F0KGlucHV0LnZhbCgpKTtcclxuICAgIGlmIChvbGRWYWx1ZSA8PSBtaW4pIHtcclxuICAgICAgICB2YXIgbmV3VmFsID0gb2xkVmFsdWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHZhciBuZXdWYWwgPSBvbGRWYWx1ZSAtIDE7XHJcbiAgICB9XHJcbiAgICBzcGlubmVyLmZpbmQoXCJpbnB1dFwiKS52YWwobmV3VmFsKTtcclxuICAgIHNwaW5uZXIuZmluZChcImlucHV0XCIpLnRyaWdnZXIoXCJjaGFuZ2VcIik7XHJcbiAgfSk7XHJcblxyXG59KTsqL1xyXG5cclxuXHQvKmxldCBBY2NvcmRpb25Nb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xyXG5cdGNvbnNvbGUubG9nKCdBY2NvcmRpb25Nb2R1bGUgb2snKTtcclxuXHRcclxuXHRmdW5jdGlvbiB0b2dnbGVDb250ZW50KG9wdGlvbnMsIGJ1dHRvbiwgdGFyZ2V0QmxvY2ssIGFsbFRhcmdldEJsb2Nrcykge1xyXG5cdFx0bGV0IHN1Yk1lbnVQYXJlbnQgPSBidXR0b24gPyBmaW5kUGFyZW50V3JhcHBlcihidXR0b24sICdtZW51V3JhcHBlcicpIDogbnVsbDtcclxuXHRcdGxldCB0YXJnZXRIZWlnaHQgPSB0YXJnZXRCbG9jayA/IHRhcmdldEJsb2NrLmZpcnN0RWxlbWVudENoaWxkLm9mZnNldEhlaWdodCA6IG51bGw7XHJcblxyXG5cdFx0ZnVuY3Rpb24gZmluZFBhcmVudFdyYXBwZXIoZWxlbWVudCwgc2VhcmNoQ2xhc3MpIHtcclxuXHRcdFx0bGV0IGZpbmRlZCA9IGZhbHNlO1xyXG5cdFx0XHRsZXQgY3VycmVudEVsZW1lbnQgPSBlbGVtZW50LCBmaW5kaW5nRWxlbWVudCA9IG51bGw7XHJcblxyXG5cdFx0XHR3aGlsZSghZmluZGVkKSB7XHJcblxyXG5cdFx0XHRcdGlmICggY3VycmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoc2VhcmNoQ2xhc3MpICkgeyBcclxuXHRcdFx0XHRcdGZpbmRpbmdFbGVtZW50ID0gY3VycmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcclxuXHRcdFx0XHRcdGZpbmRlZCA9IHRydWU7XHJcblx0XHRcdFx0fSBlbHNlIGlmIChjdXJyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnYWNjb3JkaW9uTWVudScpKSBicmVhaztcclxuXHRcdFx0XHRjdXJyZW50RWxlbWVudCA9IGN1cnJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XHJcblx0XHRcdH1cclxuXHRcdFx0cmV0dXJuIGZpbmRpbmdFbGVtZW50O1xyXG5cdFx0fVxyXG5cclxuXHRcdGZ1bmN0aW9uIHJlc2V0RHJvcERvd24odGFyZ2V0RWxlbWVudHMpIHtcclxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRFbGVtZW50cy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdHRhcmdldEVsZW1lbnRzW2ldLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcblx0XHRcdFx0dGFyZ2V0RWxlbWVudHNbaV0uc3R5bGUuaGVpZ2h0ID0gXCJcIjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHJcblx0XHRmdW5jdGlvbiBjbG9zZVNpYmxpbmdzKGJ1dHRvbiwgdGFyZ2V0RWxlbWVudHMpIHtcclxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRFbGVtZW50cy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGxldCBidXR0b24gPSB0YXJnZXRFbGVtZW50c1tpXS5wYXJlbnRFbGVtZW50XHJcblx0XHRcdFx0aWYgKGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpICkge1xyXG5cdFx0XHRcdFx0YnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG5cdFx0XHRcdFx0dGFyZ2V0RWxlbWVudHNbaV0uc3R5bGUuaGVpZ2h0ID0gXCIwcHhcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiBkcm9wRG93bihidXR0b24sIHRhcmdldEVsZW1lbnQsIHN1Yk1lbnVQYXJlbnQpIHtcclxuXHRcdFx0aWYgKCBidXR0b24uY2hlY2tlZCB8fCBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSApIHtcclxuXHRcdFx0XHRpZiAoc3ViTWVudVBhcmVudCkge1xyXG5cdFx0XHRcdFx0c3ViTWVudVBhcmVudC5zdHlsZS5oZWlnaHQgPSBzdWJNZW51UGFyZW50Lm9mZnNldEhlaWdodCArIHRhcmdldEhlaWdodCArICdweCc7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHRhcmdldEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gdGFyZ2V0SGVpZ2h0ICsgJ3B4J1xyXG5cdFx0XHR9IGVsc2Uge1x0XHRcdCBcclxuXHRcdFx0XHR0YXJnZXRFbGVtZW50LnN0eWxlLmhlaWdodCA9IFwiMHB4XCI7XHJcblx0XHRcdFx0aWYgKHN1Yk1lbnVQYXJlbnQpIHtcclxuXHRcdFx0XHRcdHN1Yk1lbnVQYXJlbnQuc3R5bGUuaGVpZ2h0ID0gIHN1Yk1lbnVQYXJlbnQub2Zmc2V0SGVpZ2h0IC0gdGFyZ2V0SGVpZ2h0ICsgJ3B4JztcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cclxuXHRcdHN3aXRjaCAob3B0aW9ucyAgfHwgJ2RlZmF1bHQnKSB7XHJcblxyXG5cdFx0XHRjYXNlICd3aXRoU2libGluZ3MnOiBcclxuXHRcdFx0XHRjbG9zZVNpYmxpbmdzKGJ1dHRvbiwgYWxsVGFyZ2V0QmxvY2tzKTtcclxuXHRcdFx0XHRkcm9wRG93bihidXR0b24sIHRhcmdldEJsb2NrLCBzdWJNZW51UGFyZW50KTtcclxuXHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRjYXNlICd3aXRob3V0U2libGluZ3MnOiBkcm9wRG93bihidXR0b24sIHRhcmdldEJsb2NrLCBzdWJNZW51UGFyZW50KTsgYnJlYWs7XHJcblxyXG5cdFx0XHRjYXNlICdyZXNldERyb3BEb3duJzogcmVzZXREcm9wRG93bihhbGxUYXJnZXRCbG9ja3MpOyBicmVhaztcclxuXHJcblxyXG5cdFx0XHRkZWZhdWx0OiBjb25zb2xlLmVycm9yKCdubyBjb3JyZWN0IG9wdGlvbiB0eXBlZCBpbiB0b2dnbGVDb250ZW50IGZ1bmN0aW9uJyk7XHJcblxyXG5cdFx0fVxyXG5cclxuXHR9XHJcbiAgICBcclxuXHQvLyAtLS0tLVJlc2l6ZSBFdmVudC0tLS0tLVxyXG5cdC8vIGNvbnN0IG1vYmlsZUZpbHRlck1lbnVCbG9ja3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjZmlsdGVyV3JhcHBlciAuZmlsdGVyLWl0ZW0gLmZpbHRlci1jb250ZW50LXdyYXBwZXInKTtcclxuXHJcblx0Ly8gbGV0IHRpbWVyID0gbnVsbDtcclxuXHJcblx0Ly8gd2luZG93Lm9ucmVzaXplID0gZnVuY3Rpb24gKCkge1xyXG5cdC8vIFx0aWYgKHRpbWVyKSB7XHJcblx0Ly8gXHRcdGNsZWFyVGltZW91dCh0aW1lcik7XHJcblx0Ly8gXHR9XHJcblxyXG5cdC8vIFx0dGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdC8vIFx0XHR0aW1lciA9IG51bGw7XHJcblxyXG4gLy8gICAgIC8vID09PT09PT1IYW5kbGVycz09PT09PT1cclxuIC8vICAgICAgaWYgKG1vYmlsZUZpbHRlck1lbnVCbG9ja3MpIHtcclxuIC8vICAgICAgXHRpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoID4gOTkxKSB7XHJcblx0Ly8gXHRcdFx0XHR0b2dnbGVDb250ZW50KFwicmVzZXREcm9wRG93blwiLCBudWxsLCBudWxsLCBtb2JpbGVGaWx0ZXJNZW51QmxvY2tzKTtcclxuXHQvLyBcdFx0XHR9XHJcbiAvLyAgICAgIH1cclxuIC8vICAgICB9LCA1MCk7XHJcblx0Ly8gfTtcclxuXHJcblx0XHJcbi8vIC0tLS0tLS0tLS0tLVxyXG5cclxuXHRyZXR1cm4ge1xyXG5cdFx0dG9nZ2xlQ29udGVudDogdG9nZ2xlQ29udGVudCxcclxuXHRcdFxyXG5cdH1cclxuXHJcblxyXG5cdFxyXG5cclxufSkoKSovXHJcblx0Lyp2YXIgVG9nZ2xlQ29udGVudE1vZHVsZSAgPSAoZnVuY3Rpb24oKSB7XHJcblx0Y29uc29sZS5sb2coJ1RvZ2dsZUNvbnRlbnRNb2R1bGUgb2snKTtcclxuXHQvLyBjb25zb2xlLnRpbWUoJ1RvZ2dsZUNvbnRlbnQgTW9kdWxlIGxvYWQnKTtcclxuXHJcblx0ZnVuY3Rpb24gdG9nZ2xlQ29udGVudChidXR0b25FbGVtZW50LCBkYXRhKSB7XHJcblx0XHRsZXQgYnV0dG9uID0gYnV0dG9uRWxlbWVudCxcclxuXHRcdFx0XHRidXR0b25EYXRhID0gZGF0YS5idXR0b25EYXRhLFxyXG5cdFx0XHRcdHRhcmdldHMgPSBkYXRhLnRhcmdldHMsXHJcblx0XHRcdFx0dGhpc1RhcmdldCA9IGRhdGEudGhpc0NvbnRlbnQsXHJcblx0XHRcdFx0dGFyZ2V0QnV0dG9ucyA9IGRhdGEudGFyZ2V0QnV0dG9ucyxcclxuXHJcblx0XHRcdFx0dGFyZ2V0c1JldmVyc2UgPSBkYXRhLnRhcmdldHNSZXZlcnNlO1xyXG5cclxuXHRcdFx0Ly8gY29uc29sZS5sb2codGhpc1RhcmdldClcclxuXHJcblx0XHRcclxuXHRcdC8vIC0tLS0tLU1ldGhvZHMtLS0tLS0tLVxyXG5cclxuXHRcdGZ1bmN0aW9uIHNjYWxlKGJ1dHRvbiwgdGFyZ2V0QmxvY2ssIGFjdGlvbikge1xyXG5cdFx0XHRpZiAoYWN0aW9uID09PSAnc2hvdycgKSB7XHJcblx0XHRcdFx0YnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcclxuXHRcdFx0XHRcdHRhcmdldEJsb2NrLmNsYXNzTGlzdC5hZGQoJ2pzX3Nob3dTY2FsZScpIDogdGFyZ2V0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnanNfc2hvd1NjYWxlJyk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0YnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcclxuXHRcdFx0XHR0YXJnZXRCbG9jay5jbGFzc0xpc3QuYWRkKCdqc19oaWRlU2NhbGUnKSA6IHRhcmdldEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2pzX2hpZGVTY2FsZScpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0ZnVuY3Rpb24gZHJvcERvd24oYnV0dG9uLCB0YXJnZXRCbG9jaywgYWN0aW9uLCBidXR0b25zRWxlbWVudHMpIHtcclxuXHRcdFx0Ly8gY29uc29sZS5sb2codGFyZ2V0QmxvY2spXHJcblx0XHRcdGlmIChhY3Rpb24gPT09ICdzaG93JyApIHtcclxuXHRcdFx0XHRidXR0b24uY2hlY2tlZCB8fCBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSA/IFxyXG5cdFx0XHRcdHRhcmdldEJsb2NrLnN0eWxlLmhlaWdodCA9IHRhcmdldEJsb2NrLmZpcnN0RWxlbWVudENoaWxkLm9mZnNldEhlaWdodCArICdweCcgOlxyXG5cdFx0XHRcdHRhcmdldEJsb2NrLnN0eWxlLmhlaWdodCA9IFwiMHB4XCI7XHJcblx0XHRcdH1cdGVsc2UgaWYgKGFjdGlvbiA9PT0gJ2hpZGVSZXZlcnNlJykge1xyXG5cdFx0XHRcdGJ1dHRvbi5jaGVja2VkIHx8IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXHJcblx0XHRcdFx0dGFyZ2V0QmxvY2suc3R5bGUuaGVpZ2h0ID0gXCIwcHhcIiA6XHJcblx0XHRcdFx0dGFyZ2V0QmxvY2suc3R5bGUuaGVpZ2h0ID0gdGFyZ2V0QmxvY2suZmlyc3RFbGVtZW50Q2hpbGQub2Zmc2V0SGVpZ2h0ICsgJ3B4JztcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5oZWlnaHQgPSBcIjBweFwiO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0ZnVuY3Rpb24gc2xpZGVMZWZ0KGJ1dHRvbiwgdGFyZ2V0QmxvY2ssIGFjdGlvbiwgYnV0dG9uc0VsZW1lbnRzKSB7XHJcblx0XHRcdC8vIGNvbnNvbGUubG9nKHRhcmdldEJsb2NrKVxyXG5cdFx0XHRpZiAoYWN0aW9uID09PSAnc2hvdycgKSB7XHJcblx0XHRcdFx0YnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcclxuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5sZWZ0ID0gIFwiMCVcIiA6IHRhcmdldEJsb2NrLnN0eWxlLmxlZnQgPSBcIjEwMCVcIjtcclxuXHRcdFx0fVx0ZWxzZSBpZiAoYWN0aW9uID09PSAnaGlkZVJldmVyc2UnKSB7XHJcblx0XHRcdFx0YnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcclxuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5sZWZ0ID0gIFwiMTAwJVwiIDogdGFyZ2V0QmxvY2suc3R5bGUubGVmdCA9IFwiMCVcIjtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5sZWZ0ID0gXCIxMDAlXCI7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiBzaG93SGlkZShidXR0b24sIHRhcmdldEJsb2NrLCBhY3Rpb24pIHtcclxuXHRcdFx0aWYgKGFjdGlvbiA9PT0gJ3Nob3cnICkge1xyXG5cdFx0XHRcdGJ1dHRvbi5jaGVja2VkIHx8IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXHJcblx0XHRcdFx0XHR0YXJnZXRCbG9jay5jbGFzc0xpc3QuYWRkKCdqc19zaG93JykgOiB0YXJnZXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdqc19zaG93Jyk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0YnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgP1xyXG5cdFx0XHRcdFx0dGFyZ2V0QmxvY2suY2xhc3NMaXN0LmFkZCgnanNfaGlkZScpIDogdGFyZ2V0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnanNfaGlkZScpO1xyXG5cdFx0XHR9XHRcclxuXHRcdH1cclxuXHJcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5cdFx0ZnVuY3Rpb24gY2xlYW5CdXR0b25zKHRhcmdldEVsZW1lbnRzKSB7XHJcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0RWxlbWVudHMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHR0YXJnZXRFbGVtZW50c1tpXS5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXHJcblx0XHRcdFx0XHR0YXJnZXRFbGVtZW50c1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSA6IG51bGw7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiB0b2dnbGUodGFyZ2V0QmxvY2tzLCBhY3Rpb24pIHtcclxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRCbG9ja3MubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRzd2l0Y2ggKGJ1dHRvbkRhdGEubWVudVR5cGUgfHwgJ2RlZmF1bHQnKSB7XHJcblx0XHRcdFx0XHRjYXNlICdzY2FsZSc6IHNjYWxlKCBidXR0b24sIHRhcmdldEJsb2Nrc1tpXSwgYWN0aW9uICk7IGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSAnZHJvcC1kb3duJzogZHJvcERvd24oIGJ1dHRvbiwgdGFyZ2V0QmxvY2tzW2ldLCBhY3Rpb24gKTsgYnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlICdkcm9wLWxlZnQnOiBzbGlkZUxlZnQoIGJ1dHRvbiwgdGFyZ2V0QmxvY2tzW2ldLCBhY3Rpb24gKTsgYnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlICdzaG93LWhpZGUnOiBzaG93SGlkZSggYnV0dG9uLCB0YXJnZXRCbG9ja3NbaV0sIGFjdGlvbiApOyBicmVhaztcclxuXHJcblx0XHRcdFx0XHRkZWZhdWx0OiBjb25zb2xlLmVycm9yKCdubyBjb3JyZWN0IFwiZGF0YS1tZW51LXR5cGVcIiBhdHRyaWJ1dGUgaXMgc2V0IHRvIHRoZSBidXR0b24gZWxlbWVudCBpbiBIVE1MIScpO1xyXG5cdFx0XHRcdH1cdFx0XHRcdFx0XHRcclxuXHRcdFx0fSAgICAgIFxyXG5cdFx0fVxyXG5cclxuXHJcblx0XHRzd2l0Y2ggKGJ1dHRvbkRhdGEuYnV0dG9uVHlwZSB8fCAnZGVmYXVsdCcpIHtcclxuXHRcdFx0Y2FzZSAnY2hlY2tib3gnOlxyXG5cdFx0XHRjYXNlICdidXR0b24nOlxyXG5cdFx0XHRjYXNlICdtZW51QnV0dG9uJzpcclxuXHRcdFx0XHRcdHRvZ2dsZSh0YXJnZXRzLCAnc2hvdycpO1xyXG5cdFx0XHRcdFx0dG9nZ2xlKHRhcmdldHNSZXZlcnNlLCAnaGlkZVJldmVyc2UnKTtcdFx0XHRcdFx0XHJcblx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdFx0Y2FzZSAnYWNjb3JkaW9uJzogXHJcblx0XHRcdFx0dG9nZ2xlKHRhcmdldHNSZXZlcnNlLCAnaGlkZScpO1xyXG5cdFx0XHRcdGNsZWFuQnV0dG9ucyh0YXJnZXRCdXR0b25zKTtcclxuXHRcdFx0XHR0b2dnbGUodGhpc1RhcmdldCwgJ3Nob3cnKTtcclxuXHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRjYXNlICdyYWRpbyc6IFxyXG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0cy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0dGFyZ2V0c1tpXS5jbGFzc0xpc3QuY29udGFpbnMoYnV0dG9uLm5hbWUpID8gdG9nZ2xlKHRhcmdldHNbaV0sIFwiaGlkZVwiKSA6IG51bGw7XHJcblx0XHRcdFx0XHR0b2dnbGUodGFyZ2V0c1tpXSwgJ3Nob3cnKTtcdFx0XHRcdCAgICAgIFxyXG5cdFx0XHRcdH1cclxuXHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRkZWZhdWx0OiBjb25zb2xlLmVycm9yKCdubyBjb3JyZWN0IFwiZGF0YS1idXR0b24tdHlwZVwiIGF0dHJpYnV0ZSBpcyBzZXQgdG8gdGhlIGJ1dHRvbiBlbGVtZW50IGluIEhUTUwhJyk7XHJcblx0XHR9XHJcblxyXG5cdH1cclxuXHJcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcblx0XHJcblxyXG5cdGZ1bmN0aW9uIHRhcmdldHNGb3JBY3Rpb24oYnV0dG9uRWxlbWVudCwgYnV0dG9uRGF0YSkge1xyXG5cdFx0bGV0IHRhcmdldHNGb3JBY3Rpb25JZCA9IGJ1dHRvbkRhdGEudGFyZ2V0ID8gYnV0dG9uRGF0YS50YXJnZXQuc3BsaXQoJyAnKSA6IG51bGwsXHJcblx0XHQgXHRcdHRhcmdldHNGb3JBY3Rpb24gPSBbXTtcclxuXHJcblx0XHRpZiAodGFyZ2V0c0ZvckFjdGlvbklkKSB7XHJcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0c0ZvckFjdGlvbklkLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dGFyZ2V0c0ZvckFjdGlvbi5wdXNoKCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXRzRm9yQWN0aW9uSWRbaV0pICk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGFyZ2V0c0ZvckFjdGlvbjtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uKGJ1dHRvbkVsZW1lbnQsIGJ1dHRvbkRhdGEpIHtcclxuXHRcdGxldFx0dGFyZ2V0c0ZvclJldmVyc2VBY3Rpb25JZCA9IGJ1dHRvbkRhdGEudGFyZ2V0UmV2ZXJzZSA/IGJ1dHRvbkRhdGEudGFyZ2V0UmV2ZXJzZS5zcGxpdCgnICcpIDogbnVsbCxcclxuXHRcdFx0XHR0YXJnZXRzRm9yQWN0aW9uR3JvdXAgPSBidXR0b25EYXRhLmdyb3VwID8gYnV0dG9uRGF0YS5ncm91cCA6IG51bGwsXHJcblx0XHRcdFx0dGFyZ2V0c0ZvclJldmVyc2VBY3Rpb24gPSBbXTtcdFxyXG5cclxuXHRcdGlmICh0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbklkKSB7XHJcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0c0ZvclJldmVyc2VBY3Rpb25JZC5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uLnB1c2goIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uSWRbaV0pICk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGlmICh0YXJnZXRzRm9yQWN0aW9uR3JvdXApIHtcclxuXHRcdFx0dGFyZ2V0c0ZvclJldmVyc2VBY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHRhcmdldHNGb3JBY3Rpb25Hcm91cCk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gdGhpc0NvbnRlbnRUYXJnZXQoYnV0dG9uRWxlbWVudCwgYnV0dG9uRGF0YSkge1xyXG5cdFx0bGV0IHRoaXNUYXJnZXQgPSBidXR0b25EYXRhLmdyb3VwID8gYnV0dG9uRWxlbWVudC5wYXJlbnRFbGVtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYnV0dG9uRGF0YS5ncm91cCkgOiBudWxsO1xyXG5cdFx0cmV0dXJuIHRoaXNUYXJnZXQ7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiB0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbkJ1dHRvbnMoYnV0dG9uRWxlbWVudCwgYnV0dG9uRGF0YSkge1xyXG5cdFx0bGV0IHRhcmdldEJ1dHRvbnMgPSBbXTtcclxuXHJcblx0XHRpZiAoYnV0dG9uRGF0YS5ncm91cCkge1xyXG5cdFx0XHRsZXQgYnV0dG9uc0FsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zaG93QnV0dG9uW2RhdGEtZ3JvdXA9XCInICsgYnV0dG9uRGF0YS5ncm91cCArICdcIl0nICk7XHJcblxyXG5cdFx0XHRpZiAoYnV0dG9uc0FsbCkge1xyXG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYnV0dG9uc0FsbC5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0YnV0dG9uc0FsbFtpXSA9PT0gYnV0dG9uRWxlbWVudCA/IG51bGwgOiB0YXJnZXRCdXR0b25zLnB1c2goYnV0dG9uc0FsbFtpXSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRhcmdldEJ1dHRvbnM7XHRcclxuXHR9XHJcblxyXG5cclxuXHQvLyAtLS0tU2hvdyBDb250ZW50IEFjdGlvbnMgLS0tLS0tLS0tXHJcblx0JCgnYm9keScpLm9uKCdjbGljaycsICcuc2hvd0J1dHRvbicsIGZ1bmN0aW9uKCkge1xyXG5cdFx0Ly8gY29uc29sZS50aW1lKCdjbGljayB0b2dnbGUgd29ya2luZyB0aW1lJyk7XHJcblxyXG5cdFx0bGV0IHRhcmdldENvbnRlbnREYXRhID0ge307XHJcblxyXG5cclxuXHRcdC8vIC0tLS0tIHRhcmdldENvbnRlbnREYXRhIGNvbnN0cnVjdG9yLS0tLS0tXHJcblx0XHRpZiAodGhpcykge1xyXG5cdFx0XHRsZXQgYnV0dG9uRGF0YSA9IHRoaXMuZGF0YXNldDtcclxuXHJcblx0XHRcdC8vIGNvbnNvbGUubG9nKGJ1dHRvbkRhdGEpXHJcblx0XHRcdHRhcmdldENvbnRlbnREYXRhID0ge307XHJcblx0XHRcdHRhcmdldENvbnRlbnREYXRhLmJ1dHRvbkRhdGEgPSBidXR0b25EYXRhO1xyXG5cdFx0XHR0YXJnZXRDb250ZW50RGF0YS50YXJnZXRzID0gdGFyZ2V0c0ZvckFjdGlvbih0aGlzLCBidXR0b25EYXRhICk7XHJcblx0XHRcdHRhcmdldENvbnRlbnREYXRhLnRhcmdldHNSZXZlcnNlID0gdGFyZ2V0c0ZvclJldmVyc2VBY3Rpb24odGhpcywgYnV0dG9uRGF0YSApO1xyXG5cclxuXHRcdFx0aWYgKGJ1dHRvbkRhdGEuYnV0dG9uVHlwZSA9PT0gXCJhY2NvcmRpb25cIikge1xyXG5cdFx0XHRcdHRhcmdldENvbnRlbnREYXRhLnRoaXNDb250ZW50ID0gdGhpc0NvbnRlbnRUYXJnZXQodGhpcywgYnV0dG9uRGF0YSk7XHJcblx0XHRcdFx0dGFyZ2V0Q29udGVudERhdGEudGFyZ2V0QnV0dG9ucyA9IHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uQnV0dG9ucyh0aGlzLCBidXR0b25EYXRhKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gLS0tLS0tLS1BY3Rpb25zL0V2ZW50cy0tLS0tLS0tXHJcblxyXG5cdFx0XHRpZiAoYnV0dG9uRGF0YS5idXR0b25UeXBlID09PSBcIm1lbnVCdXR0b25cIikge1xyXG5cdFx0XHRcdHRvZ2dsZUJ1dHRvbkNvbnRlbnQodGhpcyk7XHJcblx0XHRcdFx0dGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXHJcblx0XHRcdFx0UG9wdXBNb2R1bGUuc2hvd092ZXJsYXkoXCJtZW51XCIsIHBhZ2VPdmVybGF5KSA6IFxyXG5cdFx0XHRcdFBvcHVwTW9kdWxlLmhpZGVPdmVybGF5KFwibWVudVwiLCBwYWdlT3ZlcmxheSk7XHJcblxyXG5cdFx0XHRcdHRvZ2dsZUNvbnRlbnQodGhpcywgdGFyZ2V0Q29udGVudERhdGEpO1xyXG5cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0b2dnbGVCdXR0b25Db250ZW50KHRoaXMpO1xyXG5cdFx0XHRcdHRvZ2dsZUNvbnRlbnQodGhpcywgdGFyZ2V0Q29udGVudERhdGEpO1x0XHRcdFx0XHJcblx0XHRcdH1cclxuXHJcblx0XHR9XHJcblx0XHQvLyBjb25zb2xlLnRpbWVFbmQoJ2NsaWNrIHRvZ2dsZSB3b3JraW5nIHRpbWUnKTtcclxuXHRcdFx0XHJcblx0fSk7XHJcblxyXG5cclxufSkoKTsqL1xyXG5cdC8qdmFyIFN3aXRjaFRhYnNNb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xyXG5cdGNvbnNvbGUubG9nKCdTd2l0Y2hUYWJzTW9kdWxlIG9rJyk7XHJcblxyXG5cdFx0Y29uc3QgdGFic0J1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFic05hdiAudGFiJyksXHJcblx0XHR0YWJzQmxvY2tzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b2dnbGVCbG9jaycpO1xyXG5cclxuXHRcdGZ1bmN0aW9uIHN3aXRjaFRhYnModGFiQnV0dG9uLCB0YWJzQmxvY2tzKSB7XHJcblx0XHRcdGxldCB0YXJnZXQgPSB0YWJCdXR0b24uZGF0YXNldC50YXJnZXQ7XHJcblxyXG5cdFx0XHRpZiAoICF0YWJCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSApIHtcclxuXHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhYnNCbG9ja3MubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRcdHRhYnNCdXR0b25zW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG5cdFx0XHRcdFx0dGFic0Jsb2Nrc1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuXHJcblx0XHRcdFx0XHRpZiAodGFyZ2V0ID09PSB0YWJzQmxvY2tzW2ldLmlkKSB7XHJcblx0XHRcdFx0XHRcdHRhYkJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgXHJcblx0XHRcdFx0XHRcdHRhYnNCbG9ja3NbaV0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7IFxyXG5cdFx0XHRcdFx0fSBcclxuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdCAgLy8gLS0tZXZlbnRzLS0tXHJcblxyXG5cdCAgZm9yIChsZXQgaSA9IDA7IGkgPCB0YWJzQnV0dG9ucy5sZW5ndGg7IGkrKykge1xyXG5cdCAgXHR0YWJzQnV0dG9uc1tpXS5vbmNsaWNrID0gZnVuY3Rpb24gKCkge1xyXG5cdCAgXHRcdHN3aXRjaFRhYnModGhpcywgdGFic0Jsb2Nrc0xpc3QpO1xyXG5cdCAgXHR9XHJcblx0ICB9XHJcblxyXG4gIH0pKCk7Ki9cclxuXHQvKmNvbnNvbGUubG9nKCdQb3B1cE1vZHVsZSBvaycpO1xyXG5cclxuZnVuY3Rpb24gc2hvd092ZXJsYXkob3ZlcmxheVR5cGUsIG92ZXJsYXlFbGVtZW50KSB7XHJcblxyXG4gIHN3aXRjaCAob3ZlcmxheVR5cGUpIHtcclxuICAgIGNhc2UgXCJwb3B1cFwiOlxyXG4gICAgICBpZiAoIW92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanNfb3BlblBvcHVwJykpIHtcclxuICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS56SW5kZXggPSAxMTUwO1xyXG4gICAgICAgIG92ZXJsYXlFbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XHJcbiAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnanNfb3BlblBvcHVwJyk7XHJcbiAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnanNfb3BlbicpO1xyXG5cclxuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoXCJqc19wYWdlT3ZlcmxheU9wZW5cIik7XHJcbiAgICAgIH0gXHJcbiAgICBicmVhaztcclxuXHJcbiAgICBjYXNlIFwibWVudVwiOlxyXG4gICAgICBpZiAoIW92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanNfb3Blbk1lbnUnKSkge1xyXG4gICAgICAgIG92ZXJsYXlFbGVtZW50LnN0eWxlLnpJbmRleCA9IDkwMDtcclxuICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xyXG4gICAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2pzX29wZW5NZW51Jyk7XHJcbiAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnanNfb3BlbicpO1xyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcImpzX3BhZ2VPdmVybGF5T3BlblwiKTtcclxuICAgICAgfSBcclxuICAgIGJyZWFrO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gaGlkZU92ZXJsYXkob3ZlcmxheVR5cGUsIG92ZXJsYXlFbGVtZW50KSB7XHJcblxyXG4gIHN3aXRjaCAob3ZlcmxheVR5cGUpIHtcclxuICAgIGNhc2UgXCJwb3B1cFwiOlxyXG4gICAgICBpZiAob3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuUG9wdXAnKSkge1xyXG4gICAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2pzX29wZW5Qb3B1cCcpO1xyXG4gICAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2pzX29wZW4nKTtcclxuXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKFwianNfcGFnZU92ZXJsYXlPcGVuXCIpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgaWYgKCFvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW5Qb3B1cCcpKSB7XHJcbiAgICAgICAgICAgIG92ZXJsYXlFbGVtZW50LnN0eWxlLnpJbmRleCA9IC0xMDtcclxuICAgICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sIDMwMClcclxuICAgICAgfVxyXG4gICAgYnJlYWs7XHJcblxyXG4gICAgY2FzZSBcIm1lbnVcIjpcclxuICAgIGlmICghb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuTWVudScpKSB7XHJcbiAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2pzX29wZW5NZW51Jyk7XHJcbiAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2pzX29wZW4nKTtcclxuICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKFwianNfcGFnZU92ZXJsYXlPcGVuXCIpO1xyXG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIW92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanNfb3Blbk1lbnUnKSkge1xyXG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUuekluZGV4ID0gLTEwO1xyXG4gICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xyXG4gICAgICAgIH1cclxuICAgICAgfSwgMzAwKVxyXG4gICAgfVxyXG4gICAgYnJlYWs7XHJcbiAgfVxyXG59XHJcblxyXG4vLyA9PT09PT09PT09PT09PVBvcHVwIE9wZW4vQ2xvc2UgTW9kdWxlID09PT09PT09PT09PT09XHJcblBvcHVwTW9kdWxlID0gKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgZnVuY3Rpb24gdG9nZ2xlU2hvdyhldmVudCwgcG9wdXBCbG9jaykge1xyXG4gICAgLy8gY29uc29sZS5sb2coJ2V2ZW50LCcpXHJcbiAgICBpZiAoIGV2ZW50LnByb3BlcnR5TmFtZSA9PSAnb3BhY2l0eScgKSB7XHJcbiAgICAgIHBvcHVwQmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdhbmltYXRlJykgPyBudWxsIDogcG9wdXBCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdqc19vcGVuJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBpZiAobW9kYWxzLmxlbmd0aCkge1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtb2RhbHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgbW9kYWxzW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgdG9nZ2xlU2hvdyhldmVudCwgbW9kYWxzW2ldKVxyXG4gICAgICB9LCBmYWxzZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuXHRmdW5jdGlvbiBvcGVuUG9wdXAocG9wdXBCbG9jaywgb3ZlcmxheUJsb2NrKSB7XHJcbiAgICBsZXQgb3ZlcmxheSA9IG92ZXJsYXlCbG9jayB8fCBwYWdlT3ZlcmxheTtcclxuXHJcbiAgICBsZXQgcG9wdXAgPSBwb3B1cEJsb2NrLmxlbmd0aCA/IHBvcHVwQmxvY2tbMF0gOiBwb3B1cEJsb2NrO1xyXG4gICAgICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJqc19vcGVuXCIpO1xyXG4gICAgICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJqc19hbmltYXRlXCIpO1xyXG5cclxuICAgIHNob3dPdmVybGF5KFwicG9wdXBcIiwgb3ZlcmxheSk7XHJcblx0fVxyXG5cclxuICBmdW5jdGlvbiBjbG9zZVBvcHVwKHBvcHVwQmxvY2ssIG92ZXJsYXlCbG9jaykge1xyXG4gICAgbGV0IG92ZXJsYXkgPSBvdmVybGF5QmxvY2sgfHwgcGFnZU92ZXJsYXk7XHJcblxyXG4gICAgbGV0IHBvcHVwID0gcG9wdXBCbG9jay5sZW5ndGggPyBwb3B1cEJsb2NrWzBdIDogcG9wdXBCbG9jaztcclxuICAgIFxyXG4gICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcImpzX2FuaW1hdGVcIik7XHJcbiAgICBoaWRlT3ZlcmxheShcInBvcHVwXCIsIG92ZXJsYXkpO1xyXG4gIH1cclxuXHJcblx0Ly8gZnVuY3Rpb24gY2xvc2VQb3B1cChwb3B1cEJsb2NrKSB7XHJcbiAgLy8gICAgIGxldCBwb3B1cCA9IHBvcHVwQmxvY2subGVuZ3RoID8gcG9wdXBCbG9ja1swXSA6IHBvcHVwQmxvY2s7XHJcbiAgICAgIFxyXG4gIC8vICAgICBwb3B1cC5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCBoaWRlUG9wdXApO1xyXG5cclxuICAvLyAgICAgZnVuY3Rpb24gaGlkZVBvcHVwKGUpIHtcclxuICAvLyAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgXHJcbiAgLy8gICAgICAgICBpZiAoIGUucHJvcGVydHlOYW1lID09ICdvcGFjaXR5JyApIHtcclxuICAvLyAgICAgICAgICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInNob3dcIik7XHJcbiAgLy8gICAgICAgICB9XHJcbiAgLy8gICAgICAgICBwb3B1cC5yZW1vdmVFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCBoaWRlUG9wdXApO1xyXG4gIC8vICAgICB9XHJcbiAgLy8gICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJqc19vcGVuXCIpO1xyXG4gIC8vICAgfVxyXG5cclxuICAvLyAtLS0tLS0tRXZlbnRzLS0tLS0tLS0gIFxyXG5cclxuICAkKCdib2R5Jykub24oJ2NsaWNrJywgJyNwYWdlT3ZlcmxheScsIGZ1bmN0aW9uKCkge1xyXG4gIFx0aGlkZU92ZXJsYXkoXCJwb3B1cFwiLCB0aGlzKTtcclxuXHJcbiAgICBpZiAobW9kYWxzKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbW9kYWxzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgbW9kYWxzW2ldLmNsYXNzTGlzdC5jb250YWlucygnanNfb3BlbicpID8gY2xvc2VQb3B1cChtb2RhbHNbaV0pIDogbnVsbDtcclxuICAgICAgfSAgICAgICBcclxuICAgIH1cclxuICB9KTtcclxuICAgXHJcbiAgJCgnYm9keScpLm9uKCdjbGljaycsICdidXR0b24ucG9wdXBDbG9zZUJ1dHRvbicsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIGNsb3NlUG9wdXAoICQodGhpcykuY2xvc2VzdCgnLnBvcHVwJykgKTtcclxuXHJcbiAgICBoaWRlT3ZlcmxheShcInBvcHVwXCIsIHBhZ2VPdmVybGF5KTtcclxuICB9KTtcclxuXHJcbiAgd2luZG93Lm9ua2V5ZG93biA9IGZ1bmN0aW9uIChlKSB7XHJcbiAgXHRpZiAoZS5rZXlDb2RlID09PSAyNyApIHtcclxuICAgICAgaWYgKHBhZ2VPdmVybGF5KSB7XHJcbiAgICAgICAgcGFnZU92ZXJsYXkuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuJykgPyBoaWRlT3ZlcmxheShcInBvcHVwXCIsIHBhZ2VPdmVybGF5KSA6IG51bGw7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChtb2RhbHMpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vZGFscy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgbW9kYWxzW2ldLmNsYXNzTGlzdC5jb250YWlucygnanNfb3BlbicpID8gY2xvc2VQb3B1cChtb2RhbHNbaV0pIDogbnVsbDtcclxuICAgICAgICB9ICAgICAgIFxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tXHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRvcGVuUG9wdXA6IG9wZW5Qb3B1cCxcclxuXHRcdGNsb3NlUG9wdXA6IGNsb3NlUG9wdXAsXHJcbiAgICBzaG93T3ZlcmxheTogc2hvd092ZXJsYXksXHJcbiAgICBoaWRlT3ZlcmxheTogaGlkZU92ZXJsYXksIFxyXG5cdH1cclxuXHJcbn0pKCk7Ki9cclxuXHQvKnZhciBUZXh0TGltaXRNb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xyXG5cdGNvbnNvbGUubG9nKCdUZXh0TGltaXRNb2R1bGUgb2snKTtcclxuXHJcblx0ZnVuY3Rpb24gc2xpY2VUZXh0KHNsaWNpbmdCbG9ja3MsIG1heExlbmd0aCkge1xyXG5cdFx0aWYgKHNsaWNpbmdCbG9ja3MpIHtcclxuXHJcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgc2xpY2luZ0Jsb2Nrcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGxldCBjdXJyZW50VGV4dCA9IHNsaWNpbmdCbG9ja3NbaV0uaW5uZXJIVE1MO1xyXG5cclxuXHRcdFx0XHRpZiAoY3VycmVudFRleHQubGVuZ3RoID4gbWF4TGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRzbGljaW5nQmxvY2tzW2ldLmlubmVySFRNTCA9IGN1cnJlbnRUZXh0LnNsaWNlKDAsIG1heExlbmd0aCkgKyAnIC4uLic7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRyZXR1cm4ge1xyXG5cdFx0c2xpY2VUZXh0OiBzbGljZVRleHQsXHJcblx0fVxyXG5cclxufSkoKTsqL1xyXG5cdC8qQW5pbWF0ZUJvcmRlciA9IGZ1bmN0aW9uIChhbmltYXRlZEJsb2Nrcywgb3B0aW9uc09iaikge1xyXG5cclxuXHR2YXIgYW5pbWF0ZWREYXNoQmxvY2tzID0gYW5pbWF0ZWRCbG9ja3M7XHJcblx0dmFyIG9wdGlvbnMgPSBvcHRpb25zT2JqO1xyXG5cclxuXHQvLyBjb25zb2xlLmxvZyhvcHRpb25zLnNoYWRlZFNlY3Rpb24pO1xyXG5cdC8vIC0tLS0tLS0tLS0gTWV0aG9kcyAtLS0tLS0tLVxyXG5cclxuXHRmdW5jdGlvbiBnZXRUb3RhbExlbmd0aChwYXJlbnRCbG9jaywgcmVjdCkge1xyXG5cdFx0Ly8gdmFyIHJhZGl1cyA9ICtyZWN0LmdldEF0dHJpYnV0ZSgncngnKTtcclxuXHRcdHZhciBsZW5ndGggPSAwO1xyXG5cdFx0dmFyIHJlY3RXaWR0aCA9IHBhcmVudEJsb2NrLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoIC0gKG9wdGlvbnMuYm9yZGVyV2lkdGggKiAyKTtcclxuXHRcdHZhciByZWN0SGVpZ2h0ID0gcGFyZW50QmxvY2suZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IC0gKG9wdGlvbnMuYm9yZGVyV2lkdGggKiAyKTtcclxuXHRcdHZhciByYWRpdXMgPSBvcHRpb25zLnJhZGl1cyA/IHJlY3RIZWlnaHQgLyAyIDogbnVsbDtcclxuXHRcdC8vIGNvbnNvbGUubG9nKHBhcmVudEJsb2NrLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoKVxyXG5cdFx0aWYgKHJhZGl1cykge1xyXG5cdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdGxlbmd0aDogKyggKHJlY3RXaWR0aCAtIHJhZGl1cyoyKSAqIDIgKSArICggMiozLjE0ICogcmFkaXVzICksXHJcblx0XHRcdFx0cmFkaXVzOiByYWRpdXNcclxuXHRcdFx0fSBcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0bGVuZ3RoOiArKCByZWN0V2lkdGggKyByZWN0SGVpZ2h0ICkgKiAyXHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGdldERhc2hBcnJheVN0cmluZyhyZWN0LCByZWN0TGVuZ3RoKSB7XHJcblx0XHR2YXIgZGFzaFRvdGFsTGVuZ3RoID0gb3B0aW9ucy5zaGFkZWRTZWN0aW9uICsgb3B0aW9ucy50cmFuc3BhcmVudFNlY3Rpb247XHJcblxyXG5cdFx0dmFyIGRhc2hRdWFudGl0eSA9IE1hdGgucm91bmQoIHJlY3RMZW5ndGggLyBkYXNoVG90YWxMZW5ndGggKVxyXG5cdFx0dmFyIGRpZmZlcmVuY2UgPSAoIGRhc2hUb3RhbExlbmd0aCpkYXNoUXVhbnRpdHkgLSByZWN0TGVuZ3RoICkgLyBkYXNoUXVhbnRpdHk7XHJcblx0XHRcclxuXHRcdGRpZmZlcmVuY2UgPSAoIE1hdGgucm91bmQoZGlmZmVyZW5jZSAqIDEwKSAvIDEwICkgLyAyO1xyXG5cclxuXHRcdG9wdGlvbnMubmV3U2hhZGVkU2VjdGlvbiA9IG9wdGlvbnMuc2hhZGVkU2VjdGlvbiAtIGRpZmZlcmVuY2U7XHJcblx0XHRvcHRpb25zLm5ld1RyYW5zcGFyZW50U2VjdGlvbiA9IG9wdGlvbnMudHJhbnNwYXJlbnRTZWN0aW9uIC0gZGlmZmVyZW5jZTtcclxuXHJcblx0XHRyZXR1cm4gb3B0aW9ucy5uZXdTaGFkZWRTZWN0aW9uICsgJyAnICsgb3B0aW9ucy5uZXdUcmFuc3BhcmVudFNlY3Rpb247XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBjeWNsZU9mZnNldChldmVudCwgYW5pbWF0ZWRCbG9jaywgZGFzaEFycmF5U3VtTnVtYmVyKSB7XHJcblx0ICBpZiAoIGV2ZW50LnByb3BlcnR5TmFtZSA9PSAnc3Ryb2tlLWRhc2hvZmZzZXQnICkge1xyXG5cdCAgXHQvLyBjb25zb2xlLmxvZygnc3Ryb2tlLWRhc2hvZmZzZXQnKVxyXG5cdCAgXHRhbmltYXRlZEJsb2NrLmNsYXNzTGlzdC5hZGQoJ2pzX3Jlc2V0VHJhbnNpdGlvbicpO1xyXG5cdCAgXHRhbmltYXRlZEJsb2NrLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWRhc2hvZmZzZXQnLCAwKTtcclxuXHQgIFx0XHJcblx0ICBcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0ICBcdFx0YW5pbWF0ZWRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdqc19yZXNldFRyYW5zaXRpb24nKTtcclxuXHQgIFx0XHRhbmltYXRlZEJsb2NrLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWRhc2hvZmZzZXQnLCBkYXNoQXJyYXlTdW1OdW1iZXIpXHRcdFx0XHJcblx0ICBcdH0sIDEwKVxyXG5cdCAgfVxyXG5cdH1cclxuXHJcblx0dmFyIGV2ZW50SGFuZGxlciA9IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHQvLyBjb25zb2xlLmxvZygnZXZlbnQ6ICcpXHJcblx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHRcdGN5Y2xlT2Zmc2V0KGV2ZW50LCB0aGlzLCB0aGlzLmRhdGFzZXQuZGFzaEFycmF5U3VtKVxyXG5cdH1cclxuXHJcblx0Ly8gLS0tLS0tLS0tLSBBY3Rpb24gLS0tLS0tLS1cclxuXHJcblx0aWYgKGFuaW1hdGVkRGFzaEJsb2Nrcy5sZW5ndGgpIHtcclxuXHJcblx0XHR2YXIgaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGFuaW1hdGVkRGFzaEJsb2Nrcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdHZhciByZWN0ID0gYW5pbWF0ZWREYXNoQmxvY2tzW2ldLnF1ZXJ5U2VsZWN0b3IoJ3JlY3QuYW5pbWF0ZWRCbG9jaycpO1xyXG5cdFx0XHRcdHZhciB0b3RhbExlbmd0aCA9IDAsIHJlc3VsdERhc2hBcnJheVN0cmluZyA9ICcnLCBkYXNoQXJyYXlTdW0gPSAwLCByYWRpdXMgPSAwO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdHJlY3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgZXZlbnRIYW5kbGVyKTtcclxuXHJcblx0XHRcdFx0dG90YWxMZW5ndGggPSBnZXRUb3RhbExlbmd0aCggYW5pbWF0ZWREYXNoQmxvY2tzW2ldLCByZWN0ICk7XHJcblx0XHRcdFx0cmFkaXVzID0gdG90YWxMZW5ndGgucmFkaXVzO1xyXG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKHRvdGFsTGVuZ3RoLmxlbmd0aClcclxuXHRcdFx0XHRyZXN1bHREYXNoQXJyYXlTdHJpbmcgPSBnZXREYXNoQXJyYXlTdHJpbmcocmVjdCwgdG90YWxMZW5ndGgubGVuZ3RoKTtcclxuXHRcdFx0XHRkYXNoQXJyYXlTdW0gPSBNYXRoLnJvdW5kKCBvcHRpb25zLm5ld1NoYWRlZFNlY3Rpb24gKyBvcHRpb25zLm5ld1RyYW5zcGFyZW50U2VjdGlvbiApO1xyXG5cdFx0XHRcdGRhc2hBcnJheVN1bSA9IG9wdGlvbnMucmV2ZXJzZSA/IGRhc2hBcnJheVN1bSA6IGRhc2hBcnJheVN1bSAqIC0xO1xyXG5cclxuXHRcdFx0XHRyZWN0LnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgb3B0aW9ucy5ib3JkZXJXaWR0aCk7XHJcblx0XHRcdFx0cmFkaXVzID8gcmVjdC5zZXRBdHRyaWJ1dGUoJ3J4JywgcmFkaXVzKSA6IG51bGw7XHJcblx0XHRcdFx0cmVjdC5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1kYXNoYXJyYXknLCByZXN1bHREYXNoQXJyYXlTdHJpbmcpO1xyXG5cdFx0XHRcdHJlY3Quc2V0QXR0cmlidXRlKCdzdHJva2UtZGFzaG9mZnNldCcsIGRhc2hBcnJheVN1bSoyKTtcclxuXHRcdFx0XHRyZWN0LnNldEF0dHJpYnV0ZSgnZGF0YS1kYXNoQXJyYXlTdW0nLCBkYXNoQXJyYXlTdW0qMik7XHJcblxyXG5cdFx0XHRcdHJlY3QuYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgZXZlbnRIYW5kbGVyKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGluaXQoKTtcclxuXHJcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG5cdFx0dmFyIHRpbWVyID0gbnVsbDtcclxuXHRcdHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHQgIGlmICh0aW1lcikgeyBjbGVhclRpbWVvdXQodGltZXIpOyB9XHJcblxyXG5cdFx0ICB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcblx0XHQgICAgdGltZXIgPSBudWxsO1xyXG5cclxuXHRcdCAgICAvLyB5b3VyIGV2ZW50IGhhbmRsaW5nIGxvZ2ljIGhlcmVcclxuXHRcdCAgICAvLyBjb25zb2xlLmxvZygncmVzaXplJylcclxuXHRcdCAgICBpbml0KClcclxuXHJcblx0XHQgIH0sIDUwKTtcclxuXHRcdH07XHJcblxyXG5cdH1cclxuXHJcbn1cclxuXHJcbiovXHJcblx0LypWYWxpZGF0aW9uTW9kdWxlID0gKGZ1bmN0aW9uKCkge1xyXG5cdGZ1bmN0aW9uIHZhbGlkYXRlKGlucHV0RWxlbWVudCwgdmFsaWRhdGlvbnNBcnJheSkge1xyXG5cdFx0Y29uc3QgdmFsaWRhdGlvbnMgPSB2YWxpZGF0aW9uc0FycmF5O1xyXG5cdFx0bGV0IG1lc3NhZ2VzID0gW107XHJcblxyXG5cdFx0ZnVuY3Rpb24gaXNOdW1iZXIoaW5wdXQpIHtcclxuXHRcdFx0cmV0dXJuICFpc05hTihwYXJzZUZsb2F0KGlucHV0LnZhbHVlKSkgJiYgaXNGaW5pdGUoaW5wdXQudmFsdWUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZ1bmN0aW9uIGlzRW1haWwoaW5wdXQpIHtcclxuXHRcdFx0dmFyIHJlZ2V4ID0gL14oW2EtekEtWjAtOV8uKy1dKStcXEAoKFthLXpBLVowLTktXSkrXFwuKSsoW2EtekEtWjAtOV17Miw0fSkrJC87XHJcblx0XHRcdFxyXG5cdFx0XHRyZXR1cm4gcmVnZXgudGVzdChpbnB1dC52YWx1ZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0ZnVuY3Rpb24gaXNFbXB0eShpbnB1dCkge1xyXG5cdFx0XHRyZXR1cm4gaW5wdXQudmFsdWUucmVwbGFjZSgvXFxzL2csXCJcIikubGVuZ3RoID8gZmFsc2UgOiB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdmFsaWRhdGlvbnMubGVuZ3RoOyBpKyspIHtcclxuXHJcblx0XHRcdHN3aXRjaCAodmFsaWRhdGlvbnNbaV0pIHtcclxuXHRcdFx0XHRjYXNlICdyZXF1aXJlZCc6IFxyXG5cdFx0XHRcdFx0aWYgKCBpc0VtcHR5KGlucHV0RWxlbWVudCkgKSB7XHJcblx0XHRcdFx0XHRcdG1lc3NhZ2VzLnB1c2goaW5wdXRFbGVtZW50LmRhdGFzZXQuZXJyb3JUZXh0KVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdFx0XHRjYXNlICdpc051bWJlcic6IFxyXG5cdFx0XHRcdFx0aWYgKCAhaXNOdW1iZXIoaW5wdXRFbGVtZW50KSApIHtcclxuXHRcdFx0XHRcdFx0bWVzc2FnZXMucHVzaChpbnB1dEVsZW1lbnQuZGF0YXNldC5lcnJvclRleHQpXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0YnJlYWs7XHJcblxyXG5cdFx0XHRcdGNhc2UgJ2lzRW1haWwnOiBcclxuXHRcdFx0XHRcdGlmICggIWlzRW1haWwoaW5wdXRFbGVtZW50KSApIHtcclxuXHRcdFx0XHRcdFx0bWVzc2FnZXMucHVzaChpbnB1dEVsZW1lbnQuZGF0YXNldC5lcnJvclRleHQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdGJyZWFrO1xyXG5cclxuXHRcdFx0XHRkZWZhdWx0OiBjb25zb2xlLmVycm9yKCdpbnZhbGlkIGlucHV0IGRhdGEtdmFsaWRhdGUgdmFsdWUnKVxyXG5cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Ly8gY29uc29sZS5sb2cobWVzc2FnZXMubGVuZ3RoID8gbWVzc2FnZXMgOiBudWxsKVxyXG5cdFx0cmV0dXJuIG1lc3NhZ2VzLmxlbmd0aCA/IG1lc3NhZ2VzIDogbnVsbDtcclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNob3dXYXJuaW5nKGlucHV0RWxlbWVudCwgbWVzc2FnZXMsIHRleHRDb2xvcikge1xyXG5cdFx0aW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2pzX2NvbnRhaW5zRXJyb3InKTtcclxuXHRcdGxldCB3YXJuaW5nTGlzdCA9ICQoJzx1bCBjbGFzcz1cImpzX3dhcm5pbmctbGlzdFwiPjwvdWw+Jyk7XHJcblxyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBtZXNzYWdlcy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRsZXQgbGlzdEVsZW1lbnQgPSAkKFwiPGxpPjwvbGk+XCIpLnRleHQobWVzc2FnZXNbaV0pO1xyXG5cdFx0XHR0ZXh0Q29sb3IgPyBsaXN0RWxlbWVudC5jc3MoJ2NvbG9yJywgdGV4dENvbG9yKSA6IG51bGw7XHJcblx0XHRcdHdhcm5pbmdMaXN0LmFwcGVuZChsaXN0RWxlbWVudClcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0JChpbnB1dEVsZW1lbnQpLmFmdGVyKHdhcm5pbmdMaXN0KVxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gaXNWYWxpZChmb3JtRWxlbWVudCkge1xyXG5cdFx0Y29uc3QgZm9ybSA9IGZvcm1FbGVtZW50IGluc3RhbmNlb2YgalF1ZXJ5ID8gZm9ybUVsZW1lbnRbMF0gOiBmb3JtRWxlbWVudDtcclxuXHRcdGNvbnN0IGlucHV0cyA9IGZvcm0ucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtdmFsaWRhdGVdJyk7XHJcblx0XHRsZXQgZXJyb3JzQ291bnRlciA9IDA7XHJcblxyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dHMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0bGV0IGVycm9yTWVzc2FnZXMgPSBbXTtcclxuXHRcdFx0bGV0IHRleHRDb2xvciA9IGlucHV0c1tpXS5kYXRhc2V0LnRleHRDb2xvcjtcclxuXHJcblx0XHRcdCQoaW5wdXRzW2ldKS5yZW1vdmVDbGFzcyhcImpzX2NvbnRhaW5zRXJyb3JcIik7XHJcblx0XHRcdCQoaW5wdXRzW2ldKS5uZXh0KCcuanNfd2FybmluZy1saXN0JykucmVtb3ZlKCk7XHJcblxyXG5cdFx0XHRsZXQgdmFsaWRhdGlvbnNBcnJheSA9IFtdO1xyXG5cdFx0XHRsZXQgaW5wdXREYXRhID0gaW5wdXRzW2ldLmRhdGFzZXQudmFsaWRhdGUgPyBpbnB1dHNbaV0uZGF0YXNldC52YWxpZGF0ZS5zcGxpdCgnICcpIDogZmFsc2U7XHJcblxyXG5cdFx0XHQvLyAtLS0tLS0tLS1cclxuXHRcdFx0aW5wdXRzW2ldLnZhbHVlID0gaW5wdXRzW2ldLnZhbHVlLnRyaW0oKTtcclxuXHRcdFx0Ly8gLS0tLS0tLS0tXHJcblxyXG5cdFx0XHR2YWxpZGF0aW9uc0FycmF5ID0gaW5wdXREYXRhID8gaW5wdXREYXRhIDogbnVsbDtcclxuXHRcdFx0Ly8gaW5wdXRzW2ldLnJlcXVpcmVkID8gdmFsaWRhdGlvbnNBcnJheS5wdXNoKCdyZXF1aXJlZCcpIDogbnVsbDtcclxuXHRcdFx0XHJcblx0XHRcdGlmICh2YWxpZGF0aW9uc0FycmF5Lmxlbmd0aCkge1xyXG5cdFx0XHRcdGxldCB2YWxpZGF0aW9uUmVzdWx0ID0gdmFsaWRhdGUoaW5wdXRzW2ldLCB2YWxpZGF0aW9uc0FycmF5KTtcclxuXHRcdFx0XHR2YWxpZGF0aW9uUmVzdWx0ID8gZXJyb3JNZXNzYWdlcyA9IHZhbGlkYXRpb25SZXN1bHQgOiBudWxsO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAoZXJyb3JNZXNzYWdlcy5sZW5ndGgpIHsgXHJcblx0XHRcdFx0c2hvd1dhcm5pbmcoaW5wdXRzW2ldLCBlcnJvck1lc3NhZ2VzLCB0ZXh0Q29sb3IpO1xyXG5cdFx0XHRcdGVycm9yc0NvdW50ZXIrKztcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBlcnJvcnNDb3VudGVyID4gMCA/IGZhbHNlIDogdHJ1ZTtcclxuXHR9XHJcblxyXG5cdC8vIC0tLS0tLS0tLS0tLS0tLVxyXG5cdHJldHVybiB7XHJcblx0XHRpc1ZhbGlkOiBpc1ZhbGlkLFxyXG5cdH1cclxufSkoKVxyXG5cclxuLy8gLS0tLS0tLS0tVmFsaWRhdGlvbiBTY3JpcHQgVGVzdC0tLS0tLS0tLS0tLS1cclxuXHJcbi8vICQoJ2JvZHknKS5vbignY2xpY2snLCAnYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nLCBmdW5jdGlvbihlKSB7XHJcbi8vIFx0Ly8gY29uc29sZS5sb2coJ29rJylcclxuLy8gXHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4vLyBcdC8vIFZhbGlkYXRpb25Nb2R1bGUuaXNWYWxpZCh0aGlzLmZvcm0pXHJcbi8vIFx0aWYoICFWYWxpZGF0aW9uTW9kdWxlLmlzVmFsaWQodGhpcy5mb3JtKSApIHtcclxuLy8gXHRcdGNvbnNvbGUubG9nKCdmb3JtIG5vdCB2YWxpZDogJywgdGhpcy5mb3JtKVxyXG4vLyBcdH0gZWxzZSB7XHJcbi8vIFx0XHRjb25zb2xlLmxvZygnZm9ybSB2YWxpZDogJywgdGhpcy5mb3JtKVxyXG4vLyBcdH1cclxuLy8gfSkqL1xyXG5cclxuXHJcblx0Ly8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuXHRcclxuXHRcdC8vIGNvbnNvbGUubG9nKCd3aW5kb3cgbG9hZCcpXHJcblxyXG5cdGlmICgkKCdib2R5JykpIHtjb25zb2xlLmxvZygnalF1ZXJ5IE9LJyl9XHJcblx0Y29uc29sZS5sb2codGVzdCk7XHJcblxyXG5cclxuICAvLyAtLS0tLS0tLS1Qb3B1cHMgQmxvY2stLS0tLS0tXHJcblxyXG5cdCQoJ2JvZHknKS5vbignY2xpY2snLCAnLm9yZGVyQnV0dG9uJywgZnVuY3Rpb24oKSB7XHJcbiAgXHQvLyBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgXHRpZiAocG9wdXBPcmRlcikge1xyXG4gIFx0XHRQb3B1cE1vZHVsZS5vcGVuUG9wdXAocG9wdXBPcmRlcik7XHJcbiAgXHR9XHJcbiAgfSk7XHJcblxyXG4gIC8vIC0tLS0tLS0tLUFjY29yZGlvbiBCbG9ja3MtLS0tLS0tXHJcblx0JCgnYWNjb3JkaW9uQmxvY2tTZWxlY3RvcicpLm9uKCdjbGljaycsICcuYnV0dG9uU2VsZWN0b3InLCBmdW5jdGlvbihlKSB7XHJcblx0XHQvLyBjb25zb2xlLnRpbWUoJ2NsaWNrIGFjY29yZGlvbiB3b3JraW5nIHRpbWUnKTtcclxuXHJcblx0XHRpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIDwgOTkyKSB7XHJcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHRcdGxldCBzdWJtZW51QmxvY2sgPSB0aGlzLm5leHRFbGVtZW50U2libGluZztcclxuXHRcdFx0bGV0IGJ1dHRvbiA9IHRoaXM7XHJcblxyXG5cdFx0Ly8gbGV0IHNpYmxpbmdzQmxvY2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3B1YmxpY0luZm9QYWdlIGFydGljbGUucHVibGljSW5mby1ibG9jayAudGl0bGVCbG9jayArIC5oaWRkZW5Db250ZW50Jyk7XHJcblxyXG5cdFx0XHR0b2dnbGVCdXR0b25Db250ZW50KGJ1dHRvbik7XHJcblx0XHRcdEFjY29yZGlvbk1vZHVsZS50b2dnbGVDb250ZW50KFwid2l0aG91dFNpYmxpbmdzXCIsIGJ1dHRvbiwgc3VibWVudUJsb2NrICk7XHJcblx0XHRcdC8vIEFjY29yZGlvbk1vZHVsZS50b2dnbGVDb250ZW50KFwid2l0aFNpYmxpbmdzXCIsIGJ1dHRvbiwgc3VibWVudUJsb2NrLCBzaWJsaW5nc0Jsb2NrcyApO1x0XHRcdFx0XHJcblxyXG5cdFx0fVxyXG5cdFx0Ly8gY29uc29sZS50aW1lRW5kKCdjbGljayBhY2NvcmRpb24gd29ya2luZyB0aW1lJyk7XHJcblx0fSlcclxuXHJcbiAgLy8gLS0tLS0tLS0tVGV4dCBMaW1pdC0tLS0tLS1cclxuXHQvLyBsZXQgdGV4dEJsb2NrcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWxlY3RvcicpO1xyXG5cdC8vIHRleHRCbG9ja3MubGVuZ3RoID8gVGV4dExpbWl0TW9kdWxlLnNsaWNlVGV4dCh0ZXh0QmxvY2tzLCAxODApIDogbnVsbDtcclxuXHRcclxuXHJcblx0Ly8gLS0tLS0tLS0tLVNjcm9sbC10byBTZWN0aW9uLS0tLS0tLS0tLS0tLS0tXHJcblx0XHJcblx0Ly8gJCgnYm9keScpLm9uKCdjbGljaycsICdhcnRpY2xlLnN0b3J5LWl0ZW0nLCBmdW5jdGlvbigpIHtcclxuXHRcdFxyXG5cdC8vIFx0JCgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xyXG5cdC8vIFx0XHRzY3JvbGxUb3A6ICQoXCIjXCIgKyAkKHRoaXMpLmF0dHIoJ2RhdGEtc3RvcnktaWQnKSApLm9mZnNldCgpLnRvcFxyXG5cdC8vIFx0fSwgNTAwKTtcclxuXHQvLyB9KVxyXG5cclxuXHJcblxyXG5cdC8vID09PT09PT09PT09SW5pdGlhbGl6YXRpb25zPT09PT09PT09PT09PVxyXG5cclxuXHQvLyBBbmltYXRlQm9yZGVyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hbmltYXRlZC1ib3JkZXItYmxvY2sgc3ZnJyksIHtcclxuXHQvLyBcdGJvcmRlcldpZHRoOiAzLFxyXG5cdC8vIFx0c2hhZGVkU2VjdGlvbjogMTAwLFxyXG5cdC8vIFx0dHJhbnNwYXJlbnRTZWN0aW9uOiAyNSxcclxuXHQvLyBcdHJldmVyc2U6IGZhbHNlLFxyXG5cdC8vIFx0cmFkaXVzOiB0cnVlIFxyXG5cdC8vIH0pXHJcblx0XHJcblx0aWYgKHdpbmRvdy5pbm5lcldpZHRoIDwgNzY4KSB7XHJcblx0XHQoZnVuY3Rpb24oKSB7XHJcblx0XHRcdGlmICghICQoJy5tYWluLXNsaWRlci1tb2JpbGUnKS5sZW5ndGgpIHJldHVybjtcclxuXHJcblx0XHRcdCQoJy5tYWluLXNsaWRlci1tb2JpbGUnKS5zbGljayh7XHJcblx0XHRcdFx0YXJyb3dzOiBmYWxzZSxcclxuXHRcdFx0XHRkb3RzOiB0cnVlLFxyXG5cdFx0XHRcdHZlcnRpY2FsOiB0cnVlXHJcblx0XHRcdH0pO1xyXG5cdFx0fSkoKTtcclxuXHR9XHJcblxyXG5cdGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+PSA3NjgpIHtcclxuXHRcdChmdW5jdGlvbigpIHtcclxuXHRcdFx0aWYoISAkKCcubWFpbi1zbGlkZXItZGVzY3RvcCcpLmxlbmd0aCkgcmV0dXJuO1xyXG5cclxuXHRcdFx0bGV0ICRzbGlkZXJEZXNjdG9wID0gJCgnLm1haW4tc2xpZGVyLWRlc2N0b3AnKTtcclxuXHRcdFx0bGV0IGNvdW50ZXIgPSAwO1xyXG5cclxuXHRcdFx0JHNsaWRlckRlc2N0b3Auc2xpY2soe1xyXG5cdFx0XHRcdGFycm93czogZmFsc2UsXHJcblx0XHRcdFx0ZG90czogdHJ1ZSxcclxuXHRcdFx0XHRmYWRlOiB0cnVlLFxyXG5cdFx0XHRcdHNwZWVkOiA5MDAsXHJcblx0XHRcdFx0YXV0b3BsYXk6IHRydWUsXHJcblx0XHQgICAgYXV0b3BsYXlTcGVlZDogNDAwMCxcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdCRzbGlkZXJEZXNjdG9wLmZpbmQoJy5zbGlkZXItZGVzY3RvcC1pdGVtOmZpcnN0LWNoaWxkJykuYWRkQ2xhc3MoJ2FuaW1hdGVkJyk7XHRcdFx0XHRcclxuXHRcdFx0fSwgMTApO1xyXG5cclxuXHRcdFx0JHNsaWRlckRlc2N0b3Aub24oJ2JlZm9yZUNoYW5nZScsIGZ1bmN0aW9uKGV2ZW50LCBzbGljaywgY3VycmVudFNsaWRlKSB7XHRcclxuXHRcdFx0XHQkKHNsaWNrWyckc2xpZGVzJ11bY3VycmVudFNsaWRlXSkucmVtb3ZlQ2xhc3MoJ2FuaW1hdGVkJyk7XHRcdFx0XHRcdFxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdCRzbGlkZXJEZXNjdG9wLm9uKCdhZnRlckNoYW5nZScsIGZ1bmN0aW9uKGV2ZW50LCBzbGljaywgY3VycmVudFNsaWRlKSB7XHJcblx0XHRcdFx0JChzbGlja1snJHNsaWRlcyddW2N1cnJlbnRTbGlkZV0pLmFkZENsYXNzKCdhbmltYXRlZCcpO1x0XHJcblxyXG5cdFx0XHRcdGNvdW50ZXIrKztcclxuXHRcdFx0XHRpZihjb3VudGVyID09IHNsaWNrWyckc2xpZGVzJ10ubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHQkKHRoaXMpLnNsaWNrKCdzbGlja1NldE9wdGlvbicsICdhdXRvcGxheScsIGZhbHNlKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHR9KSgpO1xyXG5cdH1cclxuXHJcbn0pO1xyXG5cclxuXHJcbndpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuXHRjb25zb2xlLmxvZygnd2luZG93IGxvYWQnKVxyXG5cdC8vICQoJyNwYWdlLXByZWxvYWRlcicpLmZhZGVPdXQoJ3Nsb3cnKTtcclxufVxyXG4iXX0=
