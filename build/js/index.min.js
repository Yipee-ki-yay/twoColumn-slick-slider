"use strict";jQuery(document).ready(function(){window.innerWidth<768&&jQuery(".main-slider-mobile").length&&jQuery(".main-slider-mobile").slick({arrows:!1,dots:!0}),768<=window.innerWidth&&function(){if(jQuery(".main-slider-desctop").length){var e=jQuery(".main-slider-desctop"),n=0;e.slick({arrows:!1,dots:!0,fade:!0,speed:600,autoplay:!0,autoplaySpeed:4e3});for(var i=jQuery(".slick-dots li button"),s=0;s<i.length;s++)$(i[s]).text(s);jQuery(".slick-dots li:first-child").css("display","none"),e.on("beforeChange",function(e,i,s){jQuery(i.$slides[s]).removeClass("animated")}),e.on("afterChange",function(e,i,s){jQuery(i.$slides[s]).addClass("animated"),++n==i.$slides.length&&jQuery(this).slick("slickSetOption","autoplay",!1)})}}()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImpRdWVyeSIsImRvY3VtZW50IiwicmVhZHkiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwibGVuZ3RoIiwic2xpY2siLCJhcnJvd3MiLCJkb3RzIiwic2xpZGVyRGVzY3RvcCIsImNvdW50ZXIiLCJmYWRlIiwic3BlZWQiLCJhdXRvcGxheSIsImF1dG9wbGF5U3BlZWQiLCJzbGlkZXJEb3RzIiwiaSIsIiQiLCJ0ZXh0IiwiY3NzIiwib24iLCJldmVudCIsImN1cnJlbnRTbGlkZSIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJ0aGlzIl0sIm1hcHBpbmdzIjoiYUFlQUEsT0FBQUMsVUFBQUMsTUFBQSxXQWtnQ0tDLE9BQU9DLFdBQWEsS0FFaEJKLE9BQU8sdUJBQXVCSyxRQUVwQ0wsT0FBTyx1QkFBdUJNLE1BQU0sQ0FDbkNDLFFBQVEsRUFDUkMsTUFBTSxJQUtnQixLQUFyQkwsT0FBT0MsWUFDVixXQUNDLEdBQUtKLE9BQU8sd0JBQXdCSyxPQUFwQyxDQUVBLElBQUlJLEVBQWdCVCxPQUFPLHdCQUN2QlUsRUFBVSxFQUVkRCxFQUFjSCxNQUFNLENBQ25CQyxRQUFRLEVBQ1JDLE1BQU0sRUFDTkcsTUFBTSxFQUNOQyxNQUFPLElBQ1BDLFVBQVUsRUFDUkMsY0FBZSxNQU1sQixJQUZBLElBQUlDLEVBQWFmLE9BQU8seUJBRWZnQixFQUFJLEVBQUdBLEVBQUlELEVBQVdWLE9BQVFXLElBQ3RDQyxFQUFFRixFQUFXQyxJQUFJRSxLQUFLRixHQUV2QmhCLE9BQU8sOEJBQThCbUIsSUFBSSxVQUFXLFFBT3BEVixFQUFjVyxHQUFHLGVBQWdCLFNBQVNDLEVBQU9mLEVBQU9nQixHQUN2RHRCLE9BQU9NLEVBQUEsUUFBaUJnQixJQUFlQyxZQUFZLGNBR3BEZCxFQUFjVyxHQUFHLGNBQWUsU0FBU0MsRUFBT2YsRUFBT2dCLEdBQ3REdEIsT0FBT00sRUFBQSxRQUFpQmdCLElBQWVFLFNBQVMsY0FFaERkLEdBQ2NKLEVBQUEsUUFBaUJELFFBQzlCTCxPQUFPeUIsTUFBTW5CLE1BQU0saUJBQWtCLFlBQVksTUFyQ3BEIiwiZmlsZSI6ImluZGV4Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGxldCBzdGF0dXMgPSBcIkpTIC0gT0shXCI7XG4vLyBmdW5jdGlvbiBjbChhcmcxLCBhcmcyLCBhcmczLCBhcmc0KSB7XG4vLyBcdGNvbnNvbGUubG9nKGFyZzEsIGFyZzIgfHwgJycsIGFyZzMgfHwgJycsIGFyZzQgfHwgJycpO1xuLy8gXHRyZXR1cm4gJy0nO1xuLy8gfVxuXG4vLyBjbChzdGF0dXMpO1xuXG4vLyB2YXIgUG9wdXBNb2R1bGUsIFJlY2VudEZ1bmN0aW9ucywgVmFsaWRhdGlvbk1vZHVsZTtcbi8vIHZhciBBY2NvcmRpb25Nb2R1bGU7XG4vLyB2YXIgQW5pbWF0ZUJvcmRlcjtcblxuLy8gdmFyIHBvcHVwT3JkZXIsXG4vLyBcdFx0bW9kYWxzLCBwYWdlT3ZlcmxheTtcblxuLy8gdmFyIHRlc3QgPSAnaW5jbHVkZSBqcyBlcnJvcic7XG5cbmpRdWVyeShkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG5cdC8vIGNvbnNvbGUubG9nKCdkb2N1bWVudCByZWFkeScpXG5cdC8vIHBvcHVwT3JkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncG9wdXBPcmRlcicpO1xuXHRcblx0Ly8gbW9kYWxzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgncG9wdXAnKTtcblx0Ly8gcGFnZU92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFnZU92ZXJsYXknKTtcblxuXG5cdC8vID09PT09PT09PT09PT09PT09SW5jbHVkZSBNb2R1bGVzPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cblx0Ly8gdGVzdCA9ICdpbmNsdWRlIGpzIC0gT0snO1xuXG5cblx0LypSZWNlbnRGdW5jdGlvbnMgPSAoZnVuY3Rpb24gKCkge1xuXG4gIGZ1bmN0aW9uIHJldHVybkRPTShlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQgaW5zdGFuY2VvZiBqUXVlcnkgPyBlbGVtZW50WzBdIDogZWxlbWVudDtcbiAgfVxuXG5cdGZ1bmN0aW9uIGdldEN1cnJlbnRZUG9zaXRpb24oKSB7XG5cdCAgcmV0dXJuIHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xuXHR9XG5cblx0ZnVuY3Rpb24gYWRkQ2xhc3NUbyhlbGVtZW50LCBhY3RpdmVDbGFzcykge1xuICAgIHZhciBlbGVtID0gcmV0dXJuRE9NKGVsZW1lbnQpO1xuXHRcdGlmICghZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoYWN0aXZlQ2xhc3MpKSB7XG5cdFx0XHRlbGVtLmNsYXNzTGlzdC5hZGQoYWN0aXZlQ2xhc3MpO1xuXHRcdH1cblx0fVxuXHRmdW5jdGlvbiByZW1vdmVDbGFzc0Zyb20oZWxlbWVudCwgYWN0aXZlQ2xhc3MpIHtcbiAgICB2YXIgZWxlbSA9IHJldHVybkRPTShlbGVtZW50KTtcblx0XHRpZiAoZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoYWN0aXZlQ2xhc3MpKSB7XG5cdFx0XHRlbGVtLmNsYXNzTGlzdC5yZW1vdmUoYWN0aXZlQ2xhc3MpO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIHRyYW5zaXRpb25IYW5kbGVyKGV2ZW50LCB0YXJnZXRCbG9jaywgaGlkZGVuQ29udGVudCkge1xuXHRcdGlmIChldmVudC5wcm9wZXJ0eU5hbWUpIHtcblx0XHRcdGNvbnNvbGUubG9nKGV2ZW50LnByb3BlcnR5TmFtZSkgIC8vIHlvdXIgY29kZSBoZXJlXG5cdFx0fVxuXG5cdFx0aWYgKGV2ZW50LnNyY0VsZW1lbnQpIHtcblx0XHRcdGNvbnNvbGUubG9nKGV2ZW50LnNyY0VsZW1lbnQpICAvLyB5b3VyIGNvZGUgaGVyZVxuXHRcdH1cblx0fVxuXG4gXHRmdW5jdGlvbiBnZXRDaGlsZHNUb3RhbFdpZHRoKHBhcmVudCkge1xuIFx0XHRsZXQgY2hpbGRyZW4gPSBwYXJlbnQuY2hpbGRyZW47XG4gXHRcdGxldCByZXN1bHQgPSAwO1xuXG4gXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiBcdFx0XHRyZXN1bHQgPSByZXN1bHQgKyBjaGlsZHJlbltpXS5vZmZzZXRXaWR0aDtcbiBcdFx0fVxuIFx0XHRyZXR1cm4gcmVzdWx0O1xuIFx0fVxuXG4gXHRmdW5jdGlvbiBnZXRDb29yZHNPblBhZ2UoZWxlbWVudCkgeyBcbiBcdFx0dmFyIGVsZW0gPSByZXR1cm5ET00oZWxlbWVudCk7XG4gXHRcdHZhciBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gXHRcdHJldHVybiB7XG4gXHRcdFx0dG9wOiBib3gudG9wICsgcGFnZVlPZmZzZXQsXG4gXHRcdFx0bGVmdDogYm94LmxlZnQgKyBwYWdlWE9mZnNldCxcbiBcdFx0XHRib3R0b206IGJveC5ib3R0b20gKyBwYWdlWU9mZnNldFxuIFx0XHR9O1xuIFx0fVxuXG4gXHRmdW5jdGlvbiBnZXRDb29yZHNPblNjcmVlbihlbGVtZW50KSB7XG4gXHRcdHZhciBlbGVtID0gcmV0dXJuRE9NKGVsZW1lbnQpO1xuIFx0XHR2YXIgYm94ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgXHQvLyBjb25zb2xlLmxvZyhib3gpXG5cbiAgXHRyZXR1cm4ge1xuICBcdFx0dG9wOiBib3gudG9wLFxuICBcdFx0bGVmdDogYm94LmxlZnQsXG4gIFx0XHRib3R0b206IGJveC5ib3R0b20sXG4gIFx0XHRyaWdodDogYm94LnJpZ2h0LFxuICBcdFx0d2lkdGg6IGJveC53aWR0aCxcbiAgXHRcdGhlaWdodDogYm94LmhlaWdodCxcbiAgXHR9O1xuICB9XG5cbiAgZnVuY3Rpb24gb3BlbldpZHRoKGVsZW1lbnQpIHtcbiAgXHRlbGVtZW50LnN0eWxlLndpZHRoID0gZ2V0Q2hpbGRzVG90YWxXaWR0aChlbGVtZW50KSArICdweCc7XG4gIH1cbiAgZnVuY3Rpb24gY29sbGFwc2VXaWR0aChlbGVtZW50KSB7XG4gIFx0ZWxlbWVudC5zdHlsZS53aWR0aCA9ICcwJztcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzVmlzaWJsZSh0YWcsIG9wdGlvbikge1xuICBcdGxldCBvcHQ7XG4gIFx0b3B0aW9uID8gb3B0ID0gb3B0aW9uIDogb3B0ID0gXCJ3aG9sZVwiO1xuICBcdHZhciB0ID0gJCh0YWcpO1xuICBcdHZhciB3ID0gJCh3aW5kb3cpO1xuICBcdHZhciB3dCA9IHcuc2Nyb2xsVG9wKCk7XG4gIFx0dmFyIHR0ID0gdC5vZmZzZXQoKS50b3A7XG4gIFx0dmFyIHRiID0gdHQgKyB0LmhlaWdodCgpO1xuXG4gIFx0aWYgKG9wdCA9PSBcIndob2xlXCIpIHtcbiAgXHRcdGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggPiA5OTEpIHtcbiAgXHRcdFx0cmV0dXJuICh0YiA8PSB3dCArIHcuaGVpZ2h0KCkpICYmICh0dCA+PSB3dCk7XG4gIFx0XHR9IGVsc2Uge1xuICBcdFx0XHRyZXR1cm4gKCB0dCA8PSAod3QgKyB3LmhlaWdodCgpIC8gMikgKSAmJiAodHQgPj0gd3QpO1xuICBcdFx0fVxuICBcdH1cblxuICBcdGlmIChvcHQgPT0gXCJ0b3BCb3JkZXJcIikge1xuICBcdFx0cmV0dXJuIHR0IDw9IHd0ICsgdy5oZWlnaHQoKSAtIDg5O1xuICBcdH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGlzVmlzaWJsZU9uWEF4aXMoZWxlbWVudCwgcGFyZW50KSB7XG4gICAgbGV0IGlzVmlzaWJsZU9uTGVmdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCA+IHBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0O1xuICAgIGxldCBpc1Zpc2libGVPblJpZ2h0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodCA8IHBhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodDtcbiAgICByZXR1cm4gaXNWaXNpYmxlT25MZWZ0ICYmIGlzVmlzaWJsZU9uUmlnaHQ7XG4gIH1cblxuICBmdW5jdGlvbiBpc0xhc3RDaGlsZChlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nID8gZmFsc2UgOiB0cnVlO1xuICB9XG4gIGZ1bmN0aW9uIGlzRmlyc3RDaGlsZChlbGVtZW50KSB7XG4gICAgcmV0dXJuIGVsZW1lbnQucHJldmlvdXNFbGVtZW50U2libGluZyA/IGZhbHNlIDogdHJ1ZTtcbiAgfVxuXG4gIC8vIC0tLS0tLS0tLS0tLVxuICByZXR1cm4ge1xuICAgIHJldHVybkRPTTogcmV0dXJuRE9NLFxuICBcdGdldEN1cnJlbnRZUG9zaXRpb246IGdldEN1cnJlbnRZUG9zaXRpb24sXG4gIFx0YWRkQ2xhc3NUbzogYWRkQ2xhc3NUbyxcbiAgXHRyZW1vdmVDbGFzc0Zyb206IHJlbW92ZUNsYXNzRnJvbSxcbiAgXHR0cmFuc2l0aW9uSGFuZGxlcjogdHJhbnNpdGlvbkhhbmRsZXIsXG4gIFx0Z2V0Q2hpbGRzVG90YWxXaWR0aDogZ2V0Q2hpbGRzVG90YWxXaWR0aCxcbiAgXHRnZXRDb29yZHNPblBhZ2U6IGdldENvb3Jkc09uUGFnZSxcbiAgXHRnZXRDb29yZHNPblNjcmVlbjogZ2V0Q29vcmRzT25TY3JlZW4sXG4gIFx0b3BlbldpZHRoOiBvcGVuV2lkdGgsXG4gIFx0Y29sbGFwc2VXaWR0aDogY29sbGFwc2VXaWR0aCxcbiAgXHRpc1Zpc2libGU6IGlzVmlzaWJsZSxcbiAgICBpc1Zpc2libGVPblhBeGlzOiBpc1Zpc2libGVPblhBeGlzLFxuICAgIGlzTGFzdENoaWxkOiBpc0xhc3RDaGlsZCxcbiAgICBpc0ZpcnN0Q2hpbGQ6IGlzRmlyc3RDaGlsZCxcbiAgfVxuICBcbn0pKCkqL1xuXHQvKmZ1bmN0aW9uIHRvZ2dsZUJ1dHRvbkNvbnRlbnQoYnV0dG9uRWxlbWVudCwgdGV4dCkge1xuXHRcdGxldCBidXR0b25BY3RpdmUgPSBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJyk7XG5cblx0XHRpZiAoYnV0dG9uQWN0aXZlKSB7XG5cdFx0XHR0ZXh0ID8gYnV0dG9uRWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZC5pbm5lckhUTUwgPSB0ZXh0LmRlZmF1bHQgOiBudWxsO1xuXHRcdFx0YnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHR0ZXh0ID8gYnV0dG9uRWxlbWVudC5maXJzdEVsZW1lbnRDaGlsZC5pbm5lckhUTUwgPSB0ZXh0LmFjdGl2ZSA6IG51bGw7XG5cdFx0XHRidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuXHRcdH1cblx0fSovXG5cdC8qLy8galF1ZXJ5KCc8ZGl2IGNsYXNzPVwicXVhbnRpdHktbmF2XCI+PGRpdiBjbGFzcz1cInF1YW50aXR5LWJ1dHRvbiBxdWFudGl0eS11cFwiPjwvZGl2PjxkaXYgY2xhc3M9XCJxdWFudGl0eS1idXR0b24gcXVhbnRpdHktZG93blwiPjwvZGl2PjwvZGl2PicpLmluc2VydEFmdGVyKCcucXVhbnRpdHkgaW5wdXQnKTtcbmpRdWVyeSgnLmN1c3RvbS1xdWFudGl0eScpLmVhY2goZnVuY3Rpb24oKSB7XG4gIHZhciBzcGlubmVyID0galF1ZXJ5KHRoaXMpLFxuICBpbnB1dCA9IHNwaW5uZXIuZmluZCgnaW5wdXRbdHlwZT1cIm51bWJlclwiXScpLFxuICBidG5VcCA9IHNwaW5uZXIuZmluZCgnLnF1YW50aXR5LXVwJyksXG4gIGJ0bkRvd24gPSBzcGlubmVyLmZpbmQoJy5xdWFudGl0eS1kb3duJyksXG4gIG1pbiA9IGlucHV0LmF0dHIoJ21pbicpLFxuICBtYXggPSBpbnB1dC5hdHRyKCdtYXgnKTtcblxuICBidG5VcC5jbGljayhmdW5jdGlvbigpIHtcblxuICAgIHZhciBvbGRWYWx1ZSA9IHBhcnNlRmxvYXQoaW5wdXQudmFsKCkpO1xuICAgIGlmIChvbGRWYWx1ZSA+PSBtYXgpIHtcbiAgICAgICAgdmFyIG5ld1ZhbCA9IG9sZFZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBuZXdWYWwgPSBvbGRWYWx1ZSArIDE7XG4gICAgfVxuXG4gICAgc3Bpbm5lci5maW5kKFwiaW5wdXRcIikudmFsKG5ld1ZhbCk7XG5cbiAgICBzcGlubmVyLmZpbmQoXCJpbnB1dFwiKS50cmlnZ2VyKFwiY2hhbmdlXCIpO1xuXG4gIH0pO1xuXG4gIGJ0bkRvd24uY2xpY2soZnVuY3Rpb24oKSB7XG5cbiAgICB2YXIgb2xkVmFsdWUgPSBwYXJzZUZsb2F0KGlucHV0LnZhbCgpKTtcbiAgICBpZiAob2xkVmFsdWUgPD0gbWluKSB7XG4gICAgICAgIHZhciBuZXdWYWwgPSBvbGRWYWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgbmV3VmFsID0gb2xkVmFsdWUgLSAxO1xuICAgIH1cbiAgICBzcGlubmVyLmZpbmQoXCJpbnB1dFwiKS52YWwobmV3VmFsKTtcbiAgICBzcGlubmVyLmZpbmQoXCJpbnB1dFwiKS50cmlnZ2VyKFwiY2hhbmdlXCIpO1xuICB9KTtcblxufSk7Ki9cblxuXHQvKmxldCBBY2NvcmRpb25Nb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xuXHRjb25zb2xlLmxvZygnQWNjb3JkaW9uTW9kdWxlIG9rJyk7XG5cdFxuXHRmdW5jdGlvbiB0b2dnbGVDb250ZW50KG9wdGlvbnMsIGJ1dHRvbiwgdGFyZ2V0QmxvY2ssIGFsbFRhcmdldEJsb2Nrcykge1xuXHRcdGxldCBzdWJNZW51UGFyZW50ID0gYnV0dG9uID8gZmluZFBhcmVudFdyYXBwZXIoYnV0dG9uLCAnbWVudVdyYXBwZXInKSA6IG51bGw7XG5cdFx0bGV0IHRhcmdldEhlaWdodCA9IHRhcmdldEJsb2NrID8gdGFyZ2V0QmxvY2suZmlyc3RFbGVtZW50Q2hpbGQub2Zmc2V0SGVpZ2h0IDogbnVsbDtcblxuXHRcdGZ1bmN0aW9uIGZpbmRQYXJlbnRXcmFwcGVyKGVsZW1lbnQsIHNlYXJjaENsYXNzKSB7XG5cdFx0XHRsZXQgZmluZGVkID0gZmFsc2U7XG5cdFx0XHRsZXQgY3VycmVudEVsZW1lbnQgPSBlbGVtZW50LCBmaW5kaW5nRWxlbWVudCA9IG51bGw7XG5cblx0XHRcdHdoaWxlKCFmaW5kZWQpIHtcblxuXHRcdFx0XHRpZiAoIGN1cnJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKHNlYXJjaENsYXNzKSApIHsgXG5cdFx0XHRcdFx0ZmluZGluZ0VsZW1lbnQgPSBjdXJyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50O1xuXHRcdFx0XHRcdGZpbmRlZCA9IHRydWU7XG5cdFx0XHRcdH0gZWxzZSBpZiAoY3VycmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2FjY29yZGlvbk1lbnUnKSkgYnJlYWs7XG5cdFx0XHRcdGN1cnJlbnRFbGVtZW50ID0gY3VycmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcblx0XHRcdH1cblx0XHRcdHJldHVybiBmaW5kaW5nRWxlbWVudDtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiByZXNldERyb3BEb3duKHRhcmdldEVsZW1lbnRzKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldEVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHRhcmdldEVsZW1lbnRzW2ldLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG5cdFx0XHRcdHRhcmdldEVsZW1lbnRzW2ldLnN0eWxlLmhlaWdodCA9IFwiXCI7XG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHRmdW5jdGlvbiBjbG9zZVNpYmxpbmdzKGJ1dHRvbiwgdGFyZ2V0RWxlbWVudHMpIHtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0RWxlbWVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0bGV0IGJ1dHRvbiA9IHRhcmdldEVsZW1lbnRzW2ldLnBhcmVudEVsZW1lbnRcblx0XHRcdFx0aWYgKGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpICkge1xuXHRcdFx0XHRcdGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcblx0XHRcdFx0XHR0YXJnZXRFbGVtZW50c1tpXS5zdHlsZS5oZWlnaHQgPSBcIjBweFwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGRyb3BEb3duKGJ1dHRvbiwgdGFyZ2V0RWxlbWVudCwgc3ViTWVudVBhcmVudCkge1xuXHRcdFx0aWYgKCBidXR0b24uY2hlY2tlZCB8fCBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSApIHtcblx0XHRcdFx0aWYgKHN1Yk1lbnVQYXJlbnQpIHtcblx0XHRcdFx0XHRzdWJNZW51UGFyZW50LnN0eWxlLmhlaWdodCA9IHN1Yk1lbnVQYXJlbnQub2Zmc2V0SGVpZ2h0ICsgdGFyZ2V0SGVpZ2h0ICsgJ3B4Jztcblx0XHRcdFx0fVxuXHRcdFx0XHR0YXJnZXRFbGVtZW50LnN0eWxlLmhlaWdodCA9IHRhcmdldEhlaWdodCArICdweCdcblx0XHRcdH0gZWxzZSB7XHRcdFx0IFxuXHRcdFx0XHR0YXJnZXRFbGVtZW50LnN0eWxlLmhlaWdodCA9IFwiMHB4XCI7XG5cdFx0XHRcdGlmIChzdWJNZW51UGFyZW50KSB7XG5cdFx0XHRcdFx0c3ViTWVudVBhcmVudC5zdHlsZS5oZWlnaHQgPSAgc3ViTWVudVBhcmVudC5vZmZzZXRIZWlnaHQgLSB0YXJnZXRIZWlnaHQgKyAncHgnO1xuXHRcdFx0XHR9XG5cblx0XHRcdH1cblx0XHR9XG5cblxuXHRcdHN3aXRjaCAob3B0aW9ucyAgfHwgJ2RlZmF1bHQnKSB7XG5cblx0XHRcdGNhc2UgJ3dpdGhTaWJsaW5ncyc6IFxuXHRcdFx0XHRjbG9zZVNpYmxpbmdzKGJ1dHRvbiwgYWxsVGFyZ2V0QmxvY2tzKTtcblx0XHRcdFx0ZHJvcERvd24oYnV0dG9uLCB0YXJnZXRCbG9jaywgc3ViTWVudVBhcmVudCk7XG5cdFx0XHRicmVhaztcblxuXHRcdFx0Y2FzZSAnd2l0aG91dFNpYmxpbmdzJzogZHJvcERvd24oYnV0dG9uLCB0YXJnZXRCbG9jaywgc3ViTWVudVBhcmVudCk7IGJyZWFrO1xuXG5cdFx0XHRjYXNlICdyZXNldERyb3BEb3duJzogcmVzZXREcm9wRG93bihhbGxUYXJnZXRCbG9ja3MpOyBicmVhaztcblxuXG5cdFx0XHRkZWZhdWx0OiBjb25zb2xlLmVycm9yKCdubyBjb3JyZWN0IG9wdGlvbiB0eXBlZCBpbiB0b2dnbGVDb250ZW50IGZ1bmN0aW9uJyk7XG5cblx0XHR9XG5cblx0fVxuICAgIFxuXHQvLyAtLS0tLVJlc2l6ZSBFdmVudC0tLS0tLVxuXHQvLyBjb25zdCBtb2JpbGVGaWx0ZXJNZW51QmxvY2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI2ZpbHRlcldyYXBwZXIgLmZpbHRlci1pdGVtIC5maWx0ZXItY29udGVudC13cmFwcGVyJyk7XG5cblx0Ly8gbGV0IHRpbWVyID0gbnVsbDtcblxuXHQvLyB3aW5kb3cub25yZXNpemUgPSBmdW5jdGlvbiAoKSB7XG5cdC8vIFx0aWYgKHRpbWVyKSB7XG5cdC8vIFx0XHRjbGVhclRpbWVvdXQodGltZXIpO1xuXHQvLyBcdH1cblxuXHQvLyBcdHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0Ly8gXHRcdHRpbWVyID0gbnVsbDtcblxuIC8vICAgICAvLyA9PT09PT09SGFuZGxlcnM9PT09PT09XG4gLy8gICAgICBpZiAobW9iaWxlRmlsdGVyTWVudUJsb2Nrcykge1xuIC8vICAgICAgXHRpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoID4gOTkxKSB7XG5cdC8vIFx0XHRcdFx0dG9nZ2xlQ29udGVudChcInJlc2V0RHJvcERvd25cIiwgbnVsbCwgbnVsbCwgbW9iaWxlRmlsdGVyTWVudUJsb2Nrcyk7XG5cdC8vIFx0XHRcdH1cbiAvLyAgICAgIH1cbiAvLyAgICAgfSwgNTApO1xuXHQvLyB9O1xuXG5cdFxuLy8gLS0tLS0tLS0tLS0tXG5cblx0cmV0dXJuIHtcblx0XHR0b2dnbGVDb250ZW50OiB0b2dnbGVDb250ZW50LFxuXHRcdFxuXHR9XG5cblxuXHRcblxufSkoKSovXG5cdC8qdmFyIFRvZ2dsZUNvbnRlbnRNb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xuXHRjb25zb2xlLmxvZygnVG9nZ2xlQ29udGVudE1vZHVsZSBvaycpO1xuXHQvLyBjb25zb2xlLnRpbWUoJ1RvZ2dsZUNvbnRlbnQgTW9kdWxlIGxvYWQnKTtcblxuXHRmdW5jdGlvbiB0b2dnbGVDb250ZW50KGJ1dHRvbkVsZW1lbnQsIGRhdGEpIHtcblx0XHRsZXQgYnV0dG9uID0gYnV0dG9uRWxlbWVudCxcblx0XHRcdFx0YnV0dG9uRGF0YSA9IGRhdGEuYnV0dG9uRGF0YSxcblx0XHRcdFx0dGFyZ2V0cyA9IGRhdGEudGFyZ2V0cyxcblx0XHRcdFx0dGhpc1RhcmdldCA9IGRhdGEudGhpc0NvbnRlbnQsXG5cdFx0XHRcdHRhcmdldEJ1dHRvbnMgPSBkYXRhLnRhcmdldEJ1dHRvbnMsXG5cblx0XHRcdFx0dGFyZ2V0c1JldmVyc2UgPSBkYXRhLnRhcmdldHNSZXZlcnNlO1xuXG5cdFx0XHQvLyBjb25zb2xlLmxvZyh0aGlzVGFyZ2V0KVxuXG5cdFx0XG5cdFx0Ly8gLS0tLS0tTWV0aG9kcy0tLS0tLS0tXG5cblx0XHRmdW5jdGlvbiBzY2FsZShidXR0b24sIHRhcmdldEJsb2NrLCBhY3Rpb24pIHtcblx0XHRcdGlmIChhY3Rpb24gPT09ICdzaG93JyApIHtcblx0XHRcdFx0YnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcblx0XHRcdFx0XHR0YXJnZXRCbG9jay5jbGFzc0xpc3QuYWRkKCdqc19zaG93U2NhbGUnKSA6IHRhcmdldEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2pzX3Nob3dTY2FsZScpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0YnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcblx0XHRcdFx0dGFyZ2V0QmxvY2suY2xhc3NMaXN0LmFkZCgnanNfaGlkZVNjYWxlJykgOiB0YXJnZXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdqc19oaWRlU2NhbGUnKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBkcm9wRG93bihidXR0b24sIHRhcmdldEJsb2NrLCBhY3Rpb24sIGJ1dHRvbnNFbGVtZW50cykge1xuXHRcdFx0Ly8gY29uc29sZS5sb2codGFyZ2V0QmxvY2spXG5cdFx0XHRpZiAoYWN0aW9uID09PSAnc2hvdycgKSB7XG5cdFx0XHRcdGJ1dHRvbi5jaGVja2VkIHx8IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXG5cdFx0XHRcdHRhcmdldEJsb2NrLnN0eWxlLmhlaWdodCA9IHRhcmdldEJsb2NrLmZpcnN0RWxlbWVudENoaWxkLm9mZnNldEhlaWdodCArICdweCcgOlxuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5oZWlnaHQgPSBcIjBweFwiO1xuXHRcdFx0fVx0ZWxzZSBpZiAoYWN0aW9uID09PSAnaGlkZVJldmVyc2UnKSB7XG5cdFx0XHRcdGJ1dHRvbi5jaGVja2VkIHx8IGJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXG5cdFx0XHRcdHRhcmdldEJsb2NrLnN0eWxlLmhlaWdodCA9IFwiMHB4XCIgOlxuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5oZWlnaHQgPSB0YXJnZXRCbG9jay5maXJzdEVsZW1lbnRDaGlsZC5vZmZzZXRIZWlnaHQgKyAncHgnO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGFyZ2V0QmxvY2suc3R5bGUuaGVpZ2h0ID0gXCIwcHhcIjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBzbGlkZUxlZnQoYnV0dG9uLCB0YXJnZXRCbG9jaywgYWN0aW9uLCBidXR0b25zRWxlbWVudHMpIHtcblx0XHRcdC8vIGNvbnNvbGUubG9nKHRhcmdldEJsb2NrKVxuXHRcdFx0aWYgKGFjdGlvbiA9PT0gJ3Nob3cnICkge1xuXHRcdFx0XHRidXR0b24uY2hlY2tlZCB8fCBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSA/IFxuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5sZWZ0ID0gIFwiMCVcIiA6IHRhcmdldEJsb2NrLnN0eWxlLmxlZnQgPSBcIjEwMCVcIjtcblx0XHRcdH1cdGVsc2UgaWYgKGFjdGlvbiA9PT0gJ2hpZGVSZXZlcnNlJykge1xuXHRcdFx0XHRidXR0b24uY2hlY2tlZCB8fCBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSA/IFxuXHRcdFx0XHR0YXJnZXRCbG9jay5zdHlsZS5sZWZ0ID0gIFwiMTAwJVwiIDogdGFyZ2V0QmxvY2suc3R5bGUubGVmdCA9IFwiMCVcIjtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRhcmdldEJsb2NrLnN0eWxlLmxlZnQgPSBcIjEwMCVcIjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBzaG93SGlkZShidXR0b24sIHRhcmdldEJsb2NrLCBhY3Rpb24pIHtcblx0XHRcdGlmIChhY3Rpb24gPT09ICdzaG93JyApIHtcblx0XHRcdFx0YnV0dG9uLmNoZWNrZWQgfHwgYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcblx0XHRcdFx0XHR0YXJnZXRCbG9jay5jbGFzc0xpc3QuYWRkKCdqc19zaG93JykgOiB0YXJnZXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdqc19zaG93Jyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRidXR0b24uY2hlY2tlZCB8fCBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSA/XG5cdFx0XHRcdFx0dGFyZ2V0QmxvY2suY2xhc3NMaXN0LmFkZCgnanNfaGlkZScpIDogdGFyZ2V0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnanNfaGlkZScpO1xuXHRcdFx0fVx0XG5cdFx0fVxuXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdFx0ZnVuY3Rpb24gY2xlYW5CdXR0b25zKHRhcmdldEVsZW1lbnRzKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldEVsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHRhcmdldEVsZW1lbnRzW2ldLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykgPyBcblx0XHRcdFx0XHR0YXJnZXRFbGVtZW50c1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSA6IG51bGw7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gdG9nZ2xlKHRhcmdldEJsb2NrcywgYWN0aW9uKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldEJsb2Nrcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRzd2l0Y2ggKGJ1dHRvbkRhdGEubWVudVR5cGUgfHwgJ2RlZmF1bHQnKSB7XG5cdFx0XHRcdFx0Y2FzZSAnc2NhbGUnOiBzY2FsZSggYnV0dG9uLCB0YXJnZXRCbG9ja3NbaV0sIGFjdGlvbiApOyBicmVhaztcblx0XHRcdFx0XHRjYXNlICdkcm9wLWRvd24nOiBkcm9wRG93biggYnV0dG9uLCB0YXJnZXRCbG9ja3NbaV0sIGFjdGlvbiApOyBicmVhaztcblx0XHRcdFx0XHRjYXNlICdkcm9wLWxlZnQnOiBzbGlkZUxlZnQoIGJ1dHRvbiwgdGFyZ2V0QmxvY2tzW2ldLCBhY3Rpb24gKTsgYnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnc2hvdy1oaWRlJzogc2hvd0hpZGUoIGJ1dHRvbiwgdGFyZ2V0QmxvY2tzW2ldLCBhY3Rpb24gKTsgYnJlYWs7XG5cblx0XHRcdFx0XHRkZWZhdWx0OiBjb25zb2xlLmVycm9yKCdubyBjb3JyZWN0IFwiZGF0YS1tZW51LXR5cGVcIiBhdHRyaWJ1dGUgaXMgc2V0IHRvIHRoZSBidXR0b24gZWxlbWVudCBpbiBIVE1MIScpO1xuXHRcdFx0XHR9XHRcdFx0XHRcdFx0XG5cdFx0XHR9ICAgICAgXG5cdFx0fVxuXG5cblx0XHRzd2l0Y2ggKGJ1dHRvbkRhdGEuYnV0dG9uVHlwZSB8fCAnZGVmYXVsdCcpIHtcblx0XHRcdGNhc2UgJ2NoZWNrYm94Jzpcblx0XHRcdGNhc2UgJ2J1dHRvbic6XG5cdFx0XHRjYXNlICdtZW51QnV0dG9uJzpcblx0XHRcdFx0XHR0b2dnbGUodGFyZ2V0cywgJ3Nob3cnKTtcblx0XHRcdFx0XHR0b2dnbGUodGFyZ2V0c1JldmVyc2UsICdoaWRlUmV2ZXJzZScpO1x0XHRcdFx0XHRcblx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlICdhY2NvcmRpb24nOiBcblx0XHRcdFx0dG9nZ2xlKHRhcmdldHNSZXZlcnNlLCAnaGlkZScpO1xuXHRcdFx0XHRjbGVhbkJ1dHRvbnModGFyZ2V0QnV0dG9ucyk7XG5cdFx0XHRcdHRvZ2dsZSh0aGlzVGFyZ2V0LCAnc2hvdycpO1xuXHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgJ3JhZGlvJzogXG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHRhcmdldHNbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKGJ1dHRvbi5uYW1lKSA/IHRvZ2dsZSh0YXJnZXRzW2ldLCBcImhpZGVcIikgOiBudWxsO1xuXHRcdFx0XHRcdHRvZ2dsZSh0YXJnZXRzW2ldLCAnc2hvdycpO1x0XHRcdFx0ICAgICAgXG5cdFx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXG5cdFx0XHRkZWZhdWx0OiBjb25zb2xlLmVycm9yKCdubyBjb3JyZWN0IFwiZGF0YS1idXR0b24tdHlwZVwiIGF0dHJpYnV0ZSBpcyBzZXQgdG8gdGhlIGJ1dHRvbiBlbGVtZW50IGluIEhUTUwhJyk7XG5cdFx0fVxuXG5cdH1cblxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdFxuXG5cdGZ1bmN0aW9uIHRhcmdldHNGb3JBY3Rpb24oYnV0dG9uRWxlbWVudCwgYnV0dG9uRGF0YSkge1xuXHRcdGxldCB0YXJnZXRzRm9yQWN0aW9uSWQgPSBidXR0b25EYXRhLnRhcmdldCA/IGJ1dHRvbkRhdGEudGFyZ2V0LnNwbGl0KCcgJykgOiBudWxsLFxuXHRcdCBcdFx0dGFyZ2V0c0ZvckFjdGlvbiA9IFtdO1xuXG5cdFx0aWYgKHRhcmdldHNGb3JBY3Rpb25JZCkge1xuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YXJnZXRzRm9yQWN0aW9uSWQubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGFyZ2V0c0ZvckFjdGlvbi5wdXNoKCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXRzRm9yQWN0aW9uSWRbaV0pICk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRhcmdldHNGb3JBY3Rpb247XG5cdH1cblxuXHRmdW5jdGlvbiB0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbihidXR0b25FbGVtZW50LCBidXR0b25EYXRhKSB7XG5cdFx0bGV0XHR0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbklkID0gYnV0dG9uRGF0YS50YXJnZXRSZXZlcnNlID8gYnV0dG9uRGF0YS50YXJnZXRSZXZlcnNlLnNwbGl0KCcgJykgOiBudWxsLFxuXHRcdFx0XHR0YXJnZXRzRm9yQWN0aW9uR3JvdXAgPSBidXR0b25EYXRhLmdyb3VwID8gYnV0dG9uRGF0YS5ncm91cCA6IG51bGwsXG5cdFx0XHRcdHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uID0gW107XHRcblxuXHRcdGlmICh0YXJnZXRzRm9yUmV2ZXJzZUFjdGlvbklkKSB7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uSWQubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGFyZ2V0c0ZvclJldmVyc2VBY3Rpb24ucHVzaCggZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0c0ZvclJldmVyc2VBY3Rpb25JZFtpXSkgKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKHRhcmdldHNGb3JBY3Rpb25Hcm91cCkge1xuXHRcdFx0dGFyZ2V0c0ZvclJldmVyc2VBY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHRhcmdldHNGb3JBY3Rpb25Hcm91cCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uO1xuXHR9XG5cblx0ZnVuY3Rpb24gdGhpc0NvbnRlbnRUYXJnZXQoYnV0dG9uRWxlbWVudCwgYnV0dG9uRGF0YSkge1xuXHRcdGxldCB0aGlzVGFyZ2V0ID0gYnV0dG9uRGF0YS5ncm91cCA/IGJ1dHRvbkVsZW1lbnQucGFyZW50RWxlbWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGJ1dHRvbkRhdGEuZ3JvdXApIDogbnVsbDtcblx0XHRyZXR1cm4gdGhpc1RhcmdldDtcblx0fVxuXG5cdGZ1bmN0aW9uIHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uQnV0dG9ucyhidXR0b25FbGVtZW50LCBidXR0b25EYXRhKSB7XG5cdFx0bGV0IHRhcmdldEJ1dHRvbnMgPSBbXTtcblxuXHRcdGlmIChidXR0b25EYXRhLmdyb3VwKSB7XG5cdFx0XHRsZXQgYnV0dG9uc0FsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zaG93QnV0dG9uW2RhdGEtZ3JvdXA9XCInICsgYnV0dG9uRGF0YS5ncm91cCArICdcIl0nICk7XG5cblx0XHRcdGlmIChidXR0b25zQWxsKSB7XG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgYnV0dG9uc0FsbC5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGJ1dHRvbnNBbGxbaV0gPT09IGJ1dHRvbkVsZW1lbnQgPyBudWxsIDogdGFyZ2V0QnV0dG9ucy5wdXNoKGJ1dHRvbnNBbGxbaV0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRhcmdldEJ1dHRvbnM7XHRcblx0fVxuXG5cblx0Ly8gLS0tLVNob3cgQ29udGVudCBBY3Rpb25zIC0tLS0tLS0tLVxuXHQkKCdib2R5Jykub24oJ2NsaWNrJywgJy5zaG93QnV0dG9uJywgZnVuY3Rpb24oKSB7XG5cdFx0Ly8gY29uc29sZS50aW1lKCdjbGljayB0b2dnbGUgd29ya2luZyB0aW1lJyk7XG5cblx0XHRsZXQgdGFyZ2V0Q29udGVudERhdGEgPSB7fTtcblxuXG5cdFx0Ly8gLS0tLS0gdGFyZ2V0Q29udGVudERhdGEgY29uc3RydWN0b3ItLS0tLS1cblx0XHRpZiAodGhpcykge1xuXHRcdFx0bGV0IGJ1dHRvbkRhdGEgPSB0aGlzLmRhdGFzZXQ7XG5cblx0XHRcdC8vIGNvbnNvbGUubG9nKGJ1dHRvbkRhdGEpXG5cdFx0XHR0YXJnZXRDb250ZW50RGF0YSA9IHt9O1xuXHRcdFx0dGFyZ2V0Q29udGVudERhdGEuYnV0dG9uRGF0YSA9IGJ1dHRvbkRhdGE7XG5cdFx0XHR0YXJnZXRDb250ZW50RGF0YS50YXJnZXRzID0gdGFyZ2V0c0ZvckFjdGlvbih0aGlzLCBidXR0b25EYXRhICk7XG5cdFx0XHR0YXJnZXRDb250ZW50RGF0YS50YXJnZXRzUmV2ZXJzZSA9IHRhcmdldHNGb3JSZXZlcnNlQWN0aW9uKHRoaXMsIGJ1dHRvbkRhdGEgKTtcblxuXHRcdFx0aWYgKGJ1dHRvbkRhdGEuYnV0dG9uVHlwZSA9PT0gXCJhY2NvcmRpb25cIikge1xuXHRcdFx0XHR0YXJnZXRDb250ZW50RGF0YS50aGlzQ29udGVudCA9IHRoaXNDb250ZW50VGFyZ2V0KHRoaXMsIGJ1dHRvbkRhdGEpO1xuXHRcdFx0XHR0YXJnZXRDb250ZW50RGF0YS50YXJnZXRCdXR0b25zID0gdGFyZ2V0c0ZvclJldmVyc2VBY3Rpb25CdXR0b25zKHRoaXMsIGJ1dHRvbkRhdGEpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyAtLS0tLS0tLUFjdGlvbnMvRXZlbnRzLS0tLS0tLS1cblxuXHRcdFx0aWYgKGJ1dHRvbkRhdGEuYnV0dG9uVHlwZSA9PT0gXCJtZW51QnV0dG9uXCIpIHtcblx0XHRcdFx0dG9nZ2xlQnV0dG9uQ29udGVudCh0aGlzKTtcblx0XHRcdFx0dGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpID8gXG5cdFx0XHRcdFBvcHVwTW9kdWxlLnNob3dPdmVybGF5KFwibWVudVwiLCBwYWdlT3ZlcmxheSkgOiBcblx0XHRcdFx0UG9wdXBNb2R1bGUuaGlkZU92ZXJsYXkoXCJtZW51XCIsIHBhZ2VPdmVybGF5KTtcblxuXHRcdFx0XHR0b2dnbGVDb250ZW50KHRoaXMsIHRhcmdldENvbnRlbnREYXRhKTtcblxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dG9nZ2xlQnV0dG9uQ29udGVudCh0aGlzKTtcblx0XHRcdFx0dG9nZ2xlQ29udGVudCh0aGlzLCB0YXJnZXRDb250ZW50RGF0YSk7XHRcdFx0XHRcblx0XHRcdH1cblxuXHRcdH1cblx0XHQvLyBjb25zb2xlLnRpbWVFbmQoJ2NsaWNrIHRvZ2dsZSB3b3JraW5nIHRpbWUnKTtcblx0XHRcdFxuXHR9KTtcblxuXG59KSgpOyovXG5cdC8qdmFyIFN3aXRjaFRhYnNNb2R1bGUgID0gKGZ1bmN0aW9uKCkge1xuXHRjb25zb2xlLmxvZygnU3dpdGNoVGFic01vZHVsZSBvaycpO1xuXG5cdFx0Y29uc3QgdGFic0J1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFic05hdiAudGFiJyksXG5cdFx0dGFic0Jsb2Nrc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudG9nZ2xlQmxvY2snKTtcblxuXHRcdGZ1bmN0aW9uIHN3aXRjaFRhYnModGFiQnV0dG9uLCB0YWJzQmxvY2tzKSB7XG5cdFx0XHRsZXQgdGFyZ2V0ID0gdGFiQnV0dG9uLmRhdGFzZXQudGFyZ2V0O1xuXG5cdFx0XHRpZiAoICF0YWJCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSApIHtcblx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YWJzQmxvY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0dGFic0J1dHRvbnNbaV0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG5cdFx0XHRcdFx0dGFic0Jsb2Nrc1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcblxuXHRcdFx0XHRcdGlmICh0YXJnZXQgPT09IHRhYnNCbG9ja3NbaV0uaWQpIHtcblx0XHRcdFx0XHRcdHRhYkJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsgXG5cdFx0XHRcdFx0XHR0YWJzQmxvY2tzW2ldLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOyBcblx0XHRcdFx0XHR9IFxuXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0ICAvLyAtLS1ldmVudHMtLS1cblxuXHQgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFic0J1dHRvbnMubGVuZ3RoOyBpKyspIHtcblx0ICBcdHRhYnNCdXR0b25zW2ldLm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7XG5cdCAgXHRcdHN3aXRjaFRhYnModGhpcywgdGFic0Jsb2Nrc0xpc3QpO1xuXHQgIFx0fVxuXHQgIH1cblxuICB9KSgpOyovXG5cdC8qY29uc29sZS5sb2coJ1BvcHVwTW9kdWxlIG9rJyk7XG5cbmZ1bmN0aW9uIHNob3dPdmVybGF5KG92ZXJsYXlUeXBlLCBvdmVybGF5RWxlbWVudCkge1xuXG4gIHN3aXRjaCAob3ZlcmxheVR5cGUpIHtcbiAgICBjYXNlIFwicG9wdXBcIjpcbiAgICAgIGlmICghb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuUG9wdXAnKSkge1xuICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS56SW5kZXggPSAxMTUwO1xuICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xuICAgICAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdqc19vcGVuUG9wdXAnKTtcbiAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnanNfb3BlbicpO1xuXG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcImpzX3BhZ2VPdmVybGF5T3BlblwiKTtcbiAgICAgIH0gXG4gICAgYnJlYWs7XG5cbiAgICBjYXNlIFwibWVudVwiOlxuICAgICAgaWYgKCFvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW5NZW51JykpIHtcbiAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUuekluZGV4ID0gOTAwO1xuICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ3Zpc2libGUnO1xuICAgICAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdqc19vcGVuTWVudScpO1xuICAgICAgICBvdmVybGF5RWxlbWVudC5jbGFzc0xpc3QuYWRkKCdqc19vcGVuJyk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChcImpzX3BhZ2VPdmVybGF5T3BlblwiKTtcbiAgICAgIH0gXG4gICAgYnJlYWs7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGlkZU92ZXJsYXkob3ZlcmxheVR5cGUsIG92ZXJsYXlFbGVtZW50KSB7XG5cbiAgc3dpdGNoIChvdmVybGF5VHlwZSkge1xuICAgIGNhc2UgXCJwb3B1cFwiOlxuICAgICAgaWYgKG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanNfb3BlblBvcHVwJykpIHtcbiAgICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnanNfb3BlblBvcHVwJyk7XG4gICAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2pzX29wZW4nKTtcblxuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoXCJqc19wYWdlT3ZlcmxheU9wZW5cIik7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmICghb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuUG9wdXAnKSkge1xuICAgICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUuekluZGV4ID0gLTEwO1xuICAgICAgICAgICAgb3ZlcmxheUVsZW1lbnQuc3R5bGUudmlzaWJpbGl0eSA9ICdoaWRkZW4nO1xuICAgICAgICAgIH1cbiAgICAgICAgfSwgMzAwKVxuICAgICAgfVxuICAgIGJyZWFrO1xuXG4gICAgY2FzZSBcIm1lbnVcIjpcbiAgICBpZiAoIW92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanNfb3Blbk1lbnUnKSkge1xuICAgICAgb3ZlcmxheUVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnanNfb3Blbk1lbnUnKTtcbiAgICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2pzX29wZW4nKTtcbiAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LnJlbW92ZShcImpzX3BhZ2VPdmVybGF5T3BlblwiKTtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIW92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnanNfb3Blbk1lbnUnKSkge1xuICAgICAgICAgIG92ZXJsYXlFbGVtZW50LnN0eWxlLnpJbmRleCA9IC0xMDtcbiAgICAgICAgICBvdmVybGF5RWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XG4gICAgICAgIH1cbiAgICAgIH0sIDMwMClcbiAgICB9XG4gICAgYnJlYWs7XG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT1Qb3B1cCBPcGVuL0Nsb3NlIE1vZHVsZSA9PT09PT09PT09PT09PVxuUG9wdXBNb2R1bGUgPSAoZnVuY3Rpb24gKCkge1xuXG4gIGZ1bmN0aW9uIHRvZ2dsZVNob3coZXZlbnQsIHBvcHVwQmxvY2spIHtcbiAgICAvLyBjb25zb2xlLmxvZygnZXZlbnQsJylcbiAgICBpZiAoIGV2ZW50LnByb3BlcnR5TmFtZSA9PSAnb3BhY2l0eScgKSB7XG4gICAgICBwb3B1cEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnYW5pbWF0ZScpID8gbnVsbCA6IHBvcHVwQmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnanNfb3BlbicpO1xuICAgIH1cbiAgfVxuXG4gIGlmIChtb2RhbHMubGVuZ3RoKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtb2RhbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIG1vZGFsc1tpXS5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgdG9nZ2xlU2hvdyhldmVudCwgbW9kYWxzW2ldKVxuICAgICAgfSwgZmFsc2UpO1xuICAgIH1cbiAgfVxuXG5cdGZ1bmN0aW9uIG9wZW5Qb3B1cChwb3B1cEJsb2NrLCBvdmVybGF5QmxvY2spIHtcbiAgICBsZXQgb3ZlcmxheSA9IG92ZXJsYXlCbG9jayB8fCBwYWdlT3ZlcmxheTtcblxuICAgIGxldCBwb3B1cCA9IHBvcHVwQmxvY2subGVuZ3RoID8gcG9wdXBCbG9ja1swXSA6IHBvcHVwQmxvY2s7XG4gICAgICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJqc19vcGVuXCIpO1xuICAgICAgICBwb3B1cC5jbGFzc0xpc3QuYWRkKFwianNfYW5pbWF0ZVwiKTtcblxuICAgIHNob3dPdmVybGF5KFwicG9wdXBcIiwgb3ZlcmxheSk7XG5cdH1cblxuICBmdW5jdGlvbiBjbG9zZVBvcHVwKHBvcHVwQmxvY2ssIG92ZXJsYXlCbG9jaykge1xuICAgIGxldCBvdmVybGF5ID0gb3ZlcmxheUJsb2NrIHx8IHBhZ2VPdmVybGF5O1xuXG4gICAgbGV0IHBvcHVwID0gcG9wdXBCbG9jay5sZW5ndGggPyBwb3B1cEJsb2NrWzBdIDogcG9wdXBCbG9jaztcbiAgICBcbiAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwianNfYW5pbWF0ZVwiKTtcbiAgICBoaWRlT3ZlcmxheShcInBvcHVwXCIsIG92ZXJsYXkpO1xuICB9XG5cblx0Ly8gZnVuY3Rpb24gY2xvc2VQb3B1cChwb3B1cEJsb2NrKSB7XG4gIC8vICAgICBsZXQgcG9wdXAgPSBwb3B1cEJsb2NrLmxlbmd0aCA/IHBvcHVwQmxvY2tbMF0gOiBwb3B1cEJsb2NrO1xuICAgICAgXG4gIC8vICAgICBwb3B1cC5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLCBoaWRlUG9wdXApO1xuXG4gIC8vICAgICBmdW5jdGlvbiBoaWRlUG9wdXAoZSkge1xuICAvLyAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgIFxuICAvLyAgICAgICAgIGlmICggZS5wcm9wZXJ0eU5hbWUgPT0gJ29wYWNpdHknICkge1xuICAvLyAgICAgICAgICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInNob3dcIik7XG4gIC8vICAgICAgICAgfVxuICAvLyAgICAgICAgIHBvcHVwLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsIGhpZGVQb3B1cCk7XG4gIC8vICAgICB9XG4gIC8vICAgICBwb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwianNfb3BlblwiKTtcbiAgLy8gICB9XG5cbiAgLy8gLS0tLS0tLUV2ZW50cy0tLS0tLS0tICBcblxuICAkKCdib2R5Jykub24oJ2NsaWNrJywgJyNwYWdlT3ZlcmxheScsIGZ1bmN0aW9uKCkge1xuICBcdGhpZGVPdmVybGF5KFwicG9wdXBcIiwgdGhpcyk7XG5cbiAgICBpZiAobW9kYWxzKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vZGFscy5sZW5ndGg7IGkrKykge1xuICAgICAgICBtb2RhbHNbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKCdqc19vcGVuJykgPyBjbG9zZVBvcHVwKG1vZGFsc1tpXSkgOiBudWxsO1xuICAgICAgfSAgICAgICBcbiAgICB9XG4gIH0pO1xuICAgXG4gICQoJ2JvZHknKS5vbignY2xpY2snLCAnYnV0dG9uLnBvcHVwQ2xvc2VCdXR0b24nLCBmdW5jdGlvbigpIHtcblxuICAgIGNsb3NlUG9wdXAoICQodGhpcykuY2xvc2VzdCgnLnBvcHVwJykgKTtcblxuICAgIGhpZGVPdmVybGF5KFwicG9wdXBcIiwgcGFnZU92ZXJsYXkpO1xuICB9KTtcblxuICB3aW5kb3cub25rZXlkb3duID0gZnVuY3Rpb24gKGUpIHtcbiAgXHRpZiAoZS5rZXlDb2RlID09PSAyNyApIHtcbiAgICAgIGlmIChwYWdlT3ZlcmxheSkge1xuICAgICAgICBwYWdlT3ZlcmxheS5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW4nKSA/IGhpZGVPdmVybGF5KFwicG9wdXBcIiwgcGFnZU92ZXJsYXkpIDogbnVsbDtcbiAgICAgIH1cblxuICAgICAgaWYgKG1vZGFscykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vZGFscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIG1vZGFsc1tpXS5jbGFzc0xpc3QuY29udGFpbnMoJ2pzX29wZW4nKSA/IGNsb3NlUG9wdXAobW9kYWxzW2ldKSA6IG51bGw7XG4gICAgICAgIH0gICAgICAgXG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8vIC0tLS0tLS0tLS0tLVxuXG5cdHJldHVybiB7XG5cdFx0b3BlblBvcHVwOiBvcGVuUG9wdXAsXG5cdFx0Y2xvc2VQb3B1cDogY2xvc2VQb3B1cCxcbiAgICBzaG93T3ZlcmxheTogc2hvd092ZXJsYXksXG4gICAgaGlkZU92ZXJsYXk6IGhpZGVPdmVybGF5LCBcblx0fVxuXG59KSgpOyovXG5cdC8qdmFyIFRleHRMaW1pdE1vZHVsZSAgPSAoZnVuY3Rpb24oKSB7XG5cdGNvbnNvbGUubG9nKCdUZXh0TGltaXRNb2R1bGUgb2snKTtcblxuXHRmdW5jdGlvbiBzbGljZVRleHQoc2xpY2luZ0Jsb2NrcywgbWF4TGVuZ3RoKSB7XG5cdFx0aWYgKHNsaWNpbmdCbG9ja3MpIHtcblxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBzbGljaW5nQmxvY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGxldCBjdXJyZW50VGV4dCA9IHNsaWNpbmdCbG9ja3NbaV0uaW5uZXJIVE1MO1xuXG5cdFx0XHRcdGlmIChjdXJyZW50VGV4dC5sZW5ndGggPiBtYXhMZW5ndGgpIHtcblx0XHRcdFx0XHRzbGljaW5nQmxvY2tzW2ldLmlubmVySFRNTCA9IGN1cnJlbnRUZXh0LnNsaWNlKDAsIG1heExlbmd0aCkgKyAnIC4uLic7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdH1cblx0fVxuXHRcblx0cmV0dXJuIHtcblx0XHRzbGljZVRleHQ6IHNsaWNlVGV4dCxcblx0fVxuXG59KSgpOyovXG5cdC8qQW5pbWF0ZUJvcmRlciA9IGZ1bmN0aW9uIChhbmltYXRlZEJsb2Nrcywgb3B0aW9uc09iaikge1xuXG5cdHZhciBhbmltYXRlZERhc2hCbG9ja3MgPSBhbmltYXRlZEJsb2Nrcztcblx0dmFyIG9wdGlvbnMgPSBvcHRpb25zT2JqO1xuXG5cdC8vIGNvbnNvbGUubG9nKG9wdGlvbnMuc2hhZGVkU2VjdGlvbik7XG5cdC8vIC0tLS0tLS0tLS0gTWV0aG9kcyAtLS0tLS0tLVxuXG5cdGZ1bmN0aW9uIGdldFRvdGFsTGVuZ3RoKHBhcmVudEJsb2NrLCByZWN0KSB7XG5cdFx0Ly8gdmFyIHJhZGl1cyA9ICtyZWN0LmdldEF0dHJpYnV0ZSgncngnKTtcblx0XHR2YXIgbGVuZ3RoID0gMDtcblx0XHR2YXIgcmVjdFdpZHRoID0gcGFyZW50QmxvY2suZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggLSAob3B0aW9ucy5ib3JkZXJXaWR0aCAqIDIpO1xuXHRcdHZhciByZWN0SGVpZ2h0ID0gcGFyZW50QmxvY2suZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0IC0gKG9wdGlvbnMuYm9yZGVyV2lkdGggKiAyKTtcblx0XHR2YXIgcmFkaXVzID0gb3B0aW9ucy5yYWRpdXMgPyByZWN0SGVpZ2h0IC8gMiA6IG51bGw7XG5cdFx0Ly8gY29uc29sZS5sb2cocGFyZW50QmxvY2suZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGgpXG5cdFx0aWYgKHJhZGl1cykge1xuXHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0bGVuZ3RoOiArKCAocmVjdFdpZHRoIC0gcmFkaXVzKjIpICogMiApICsgKCAyKjMuMTQgKiByYWRpdXMgKSxcblx0XHRcdFx0cmFkaXVzOiByYWRpdXNcblx0XHRcdH0gXG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGxlbmd0aDogKyggcmVjdFdpZHRoICsgcmVjdEhlaWdodCApICogMlxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIGdldERhc2hBcnJheVN0cmluZyhyZWN0LCByZWN0TGVuZ3RoKSB7XG5cdFx0dmFyIGRhc2hUb3RhbExlbmd0aCA9IG9wdGlvbnMuc2hhZGVkU2VjdGlvbiArIG9wdGlvbnMudHJhbnNwYXJlbnRTZWN0aW9uO1xuXG5cdFx0dmFyIGRhc2hRdWFudGl0eSA9IE1hdGgucm91bmQoIHJlY3RMZW5ndGggLyBkYXNoVG90YWxMZW5ndGggKVxuXHRcdHZhciBkaWZmZXJlbmNlID0gKCBkYXNoVG90YWxMZW5ndGgqZGFzaFF1YW50aXR5IC0gcmVjdExlbmd0aCApIC8gZGFzaFF1YW50aXR5O1xuXHRcdFxuXHRcdGRpZmZlcmVuY2UgPSAoIE1hdGgucm91bmQoZGlmZmVyZW5jZSAqIDEwKSAvIDEwICkgLyAyO1xuXG5cdFx0b3B0aW9ucy5uZXdTaGFkZWRTZWN0aW9uID0gb3B0aW9ucy5zaGFkZWRTZWN0aW9uIC0gZGlmZmVyZW5jZTtcblx0XHRvcHRpb25zLm5ld1RyYW5zcGFyZW50U2VjdGlvbiA9IG9wdGlvbnMudHJhbnNwYXJlbnRTZWN0aW9uIC0gZGlmZmVyZW5jZTtcblxuXHRcdHJldHVybiBvcHRpb25zLm5ld1NoYWRlZFNlY3Rpb24gKyAnICcgKyBvcHRpb25zLm5ld1RyYW5zcGFyZW50U2VjdGlvbjtcblx0fVxuXG5cdGZ1bmN0aW9uIGN5Y2xlT2Zmc2V0KGV2ZW50LCBhbmltYXRlZEJsb2NrLCBkYXNoQXJyYXlTdW1OdW1iZXIpIHtcblx0ICBpZiAoIGV2ZW50LnByb3BlcnR5TmFtZSA9PSAnc3Ryb2tlLWRhc2hvZmZzZXQnICkge1xuXHQgIFx0Ly8gY29uc29sZS5sb2coJ3N0cm9rZS1kYXNob2Zmc2V0Jylcblx0ICBcdGFuaW1hdGVkQmxvY2suY2xhc3NMaXN0LmFkZCgnanNfcmVzZXRUcmFuc2l0aW9uJyk7XG5cdCAgXHRhbmltYXRlZEJsb2NrLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWRhc2hvZmZzZXQnLCAwKTtcblx0ICBcdFxuXHQgIFx0c2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0ICBcdFx0YW5pbWF0ZWRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdqc19yZXNldFRyYW5zaXRpb24nKTtcblx0ICBcdFx0YW5pbWF0ZWRCbG9jay5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1kYXNob2Zmc2V0JywgZGFzaEFycmF5U3VtTnVtYmVyKVx0XHRcdFxuXHQgIFx0fSwgMTApXG5cdCAgfVxuXHR9XG5cblx0dmFyIGV2ZW50SGFuZGxlciA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0Ly8gY29uc29sZS5sb2coJ2V2ZW50OiAnKVxuXHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdGN5Y2xlT2Zmc2V0KGV2ZW50LCB0aGlzLCB0aGlzLmRhdGFzZXQuZGFzaEFycmF5U3VtKVxuXHR9XG5cblx0Ly8gLS0tLS0tLS0tLSBBY3Rpb24gLS0tLS0tLS1cblxuXHRpZiAoYW5pbWF0ZWREYXNoQmxvY2tzLmxlbmd0aCkge1xuXG5cdFx0dmFyIGluaXQgPSBmdW5jdGlvbigpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgYW5pbWF0ZWREYXNoQmxvY2tzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHZhciByZWN0ID0gYW5pbWF0ZWREYXNoQmxvY2tzW2ldLnF1ZXJ5U2VsZWN0b3IoJ3JlY3QuYW5pbWF0ZWRCbG9jaycpO1xuXHRcdFx0XHR2YXIgdG90YWxMZW5ndGggPSAwLCByZXN1bHREYXNoQXJyYXlTdHJpbmcgPSAnJywgZGFzaEFycmF5U3VtID0gMCwgcmFkaXVzID0gMDtcblx0XHRcdFx0XG5cdFx0XHRcdHJlY3QucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgZXZlbnRIYW5kbGVyKTtcblxuXHRcdFx0XHR0b3RhbExlbmd0aCA9IGdldFRvdGFsTGVuZ3RoKCBhbmltYXRlZERhc2hCbG9ja3NbaV0sIHJlY3QgKTtcblx0XHRcdFx0cmFkaXVzID0gdG90YWxMZW5ndGgucmFkaXVzO1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyh0b3RhbExlbmd0aC5sZW5ndGgpXG5cdFx0XHRcdHJlc3VsdERhc2hBcnJheVN0cmluZyA9IGdldERhc2hBcnJheVN0cmluZyhyZWN0LCB0b3RhbExlbmd0aC5sZW5ndGgpO1xuXHRcdFx0XHRkYXNoQXJyYXlTdW0gPSBNYXRoLnJvdW5kKCBvcHRpb25zLm5ld1NoYWRlZFNlY3Rpb24gKyBvcHRpb25zLm5ld1RyYW5zcGFyZW50U2VjdGlvbiApO1xuXHRcdFx0XHRkYXNoQXJyYXlTdW0gPSBvcHRpb25zLnJldmVyc2UgPyBkYXNoQXJyYXlTdW0gOiBkYXNoQXJyYXlTdW0gKiAtMTtcblxuXHRcdFx0XHRyZWN0LnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgb3B0aW9ucy5ib3JkZXJXaWR0aCk7XG5cdFx0XHRcdHJhZGl1cyA/IHJlY3Quc2V0QXR0cmlidXRlKCdyeCcsIHJhZGl1cykgOiBudWxsO1xuXHRcdFx0XHRyZWN0LnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWRhc2hhcnJheScsIHJlc3VsdERhc2hBcnJheVN0cmluZyk7XG5cdFx0XHRcdHJlY3Quc2V0QXR0cmlidXRlKCdzdHJva2UtZGFzaG9mZnNldCcsIGRhc2hBcnJheVN1bSoyKTtcblx0XHRcdFx0cmVjdC5zZXRBdHRyaWJ1dGUoJ2RhdGEtZGFzaEFycmF5U3VtJywgZGFzaEFycmF5U3VtKjIpO1xuXG5cdFx0XHRcdHJlY3QuYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgZXZlbnRIYW5kbGVyKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpbml0KCk7XG5cblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0XHR2YXIgdGltZXIgPSBudWxsO1xuXHRcdHdpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0ICBpZiAodGltZXIpIHsgY2xlYXJUaW1lb3V0KHRpbWVyKTsgfVxuXG5cdFx0ICB0aW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0ICAgIHRpbWVyID0gbnVsbDtcblxuXHRcdCAgICAvLyB5b3VyIGV2ZW50IGhhbmRsaW5nIGxvZ2ljIGhlcmVcblx0XHQgICAgLy8gY29uc29sZS5sb2coJ3Jlc2l6ZScpXG5cdFx0ICAgIGluaXQoKVxuXG5cdFx0ICB9LCA1MCk7XG5cdFx0fTtcblxuXHR9XG5cbn1cblxuKi9cblx0LypWYWxpZGF0aW9uTW9kdWxlID0gKGZ1bmN0aW9uKCkge1xuXHRmdW5jdGlvbiB2YWxpZGF0ZShpbnB1dEVsZW1lbnQsIHZhbGlkYXRpb25zQXJyYXkpIHtcblx0XHRjb25zdCB2YWxpZGF0aW9ucyA9IHZhbGlkYXRpb25zQXJyYXk7XG5cdFx0bGV0IG1lc3NhZ2VzID0gW107XG5cblx0XHRmdW5jdGlvbiBpc051bWJlcihpbnB1dCkge1xuXHRcdFx0cmV0dXJuICFpc05hTihwYXJzZUZsb2F0KGlucHV0LnZhbHVlKSkgJiYgaXNGaW5pdGUoaW5wdXQudmFsdWUpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGlzRW1haWwoaW5wdXQpIHtcblx0XHRcdHZhciByZWdleCA9IC9eKFthLXpBLVowLTlfListXSkrXFxAKChbYS16QS1aMC05LV0pK1xcLikrKFthLXpBLVowLTldezIsNH0pKyQvO1xuXHRcdFx0XG5cdFx0XHRyZXR1cm4gcmVnZXgudGVzdChpbnB1dC52YWx1ZSk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gaXNFbXB0eShpbnB1dCkge1xuXHRcdFx0cmV0dXJuIGlucHV0LnZhbHVlLnJlcGxhY2UoL1xccy9nLFwiXCIpLmxlbmd0aCA/IGZhbHNlIDogdHJ1ZTtcblx0XHR9XG5cblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdmFsaWRhdGlvbnMubGVuZ3RoOyBpKyspIHtcblxuXHRcdFx0c3dpdGNoICh2YWxpZGF0aW9uc1tpXSkge1xuXHRcdFx0XHRjYXNlICdyZXF1aXJlZCc6IFxuXHRcdFx0XHRcdGlmICggaXNFbXB0eShpbnB1dEVsZW1lbnQpICkge1xuXHRcdFx0XHRcdFx0bWVzc2FnZXMucHVzaChpbnB1dEVsZW1lbnQuZGF0YXNldC5lcnJvclRleHQpXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRjYXNlICdpc051bWJlcic6IFxuXHRcdFx0XHRcdGlmICggIWlzTnVtYmVyKGlucHV0RWxlbWVudCkgKSB7XG5cdFx0XHRcdFx0XHRtZXNzYWdlcy5wdXNoKGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yVGV4dClcblx0XHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgJ2lzRW1haWwnOiBcblx0XHRcdFx0XHRpZiAoICFpc0VtYWlsKGlucHV0RWxlbWVudCkgKSB7XG5cdFx0XHRcdFx0XHRtZXNzYWdlcy5wdXNoKGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yVGV4dCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblxuXHRcdFx0XHRkZWZhdWx0OiBjb25zb2xlLmVycm9yKCdpbnZhbGlkIGlucHV0IGRhdGEtdmFsaWRhdGUgdmFsdWUnKVxuXG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIGNvbnNvbGUubG9nKG1lc3NhZ2VzLmxlbmd0aCA/IG1lc3NhZ2VzIDogbnVsbClcblx0XHRyZXR1cm4gbWVzc2FnZXMubGVuZ3RoID8gbWVzc2FnZXMgOiBudWxsO1xuXHR9XG5cblx0ZnVuY3Rpb24gc2hvd1dhcm5pbmcoaW5wdXRFbGVtZW50LCBtZXNzYWdlcywgdGV4dENvbG9yKSB7XG5cdFx0aW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2pzX2NvbnRhaW5zRXJyb3InKTtcblx0XHRsZXQgd2FybmluZ0xpc3QgPSAkKCc8dWwgY2xhc3M9XCJqc193YXJuaW5nLWxpc3RcIj48L3VsPicpO1xuXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBtZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IGxpc3RFbGVtZW50ID0gJChcIjxsaT48L2xpPlwiKS50ZXh0KG1lc3NhZ2VzW2ldKTtcblx0XHRcdHRleHRDb2xvciA/IGxpc3RFbGVtZW50LmNzcygnY29sb3InLCB0ZXh0Q29sb3IpIDogbnVsbDtcblx0XHRcdHdhcm5pbmdMaXN0LmFwcGVuZChsaXN0RWxlbWVudClcblx0XHR9XG5cdFx0XG5cdFx0JChpbnB1dEVsZW1lbnQpLmFmdGVyKHdhcm5pbmdMaXN0KVxuXHR9XG5cblx0ZnVuY3Rpb24gaXNWYWxpZChmb3JtRWxlbWVudCkge1xuXHRcdGNvbnN0IGZvcm0gPSBmb3JtRWxlbWVudCBpbnN0YW5jZW9mIGpRdWVyeSA/IGZvcm1FbGVtZW50WzBdIDogZm9ybUVsZW1lbnQ7XG5cdFx0Y29uc3QgaW5wdXRzID0gZm9ybS5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS12YWxpZGF0ZV0nKTtcblx0XHRsZXQgZXJyb3JzQ291bnRlciA9IDA7XG5cblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0bGV0IGVycm9yTWVzc2FnZXMgPSBbXTtcblx0XHRcdGxldCB0ZXh0Q29sb3IgPSBpbnB1dHNbaV0uZGF0YXNldC50ZXh0Q29sb3I7XG5cblx0XHRcdCQoaW5wdXRzW2ldKS5yZW1vdmVDbGFzcyhcImpzX2NvbnRhaW5zRXJyb3JcIik7XG5cdFx0XHQkKGlucHV0c1tpXSkubmV4dCgnLmpzX3dhcm5pbmctbGlzdCcpLnJlbW92ZSgpO1xuXG5cdFx0XHRsZXQgdmFsaWRhdGlvbnNBcnJheSA9IFtdO1xuXHRcdFx0bGV0IGlucHV0RGF0YSA9IGlucHV0c1tpXS5kYXRhc2V0LnZhbGlkYXRlID8gaW5wdXRzW2ldLmRhdGFzZXQudmFsaWRhdGUuc3BsaXQoJyAnKSA6IGZhbHNlO1xuXG5cdFx0XHQvLyAtLS0tLS0tLS1cblx0XHRcdGlucHV0c1tpXS52YWx1ZSA9IGlucHV0c1tpXS52YWx1ZS50cmltKCk7XG5cdFx0XHQvLyAtLS0tLS0tLS1cblxuXHRcdFx0dmFsaWRhdGlvbnNBcnJheSA9IGlucHV0RGF0YSA/IGlucHV0RGF0YSA6IG51bGw7XG5cdFx0XHQvLyBpbnB1dHNbaV0ucmVxdWlyZWQgPyB2YWxpZGF0aW9uc0FycmF5LnB1c2goJ3JlcXVpcmVkJykgOiBudWxsO1xuXHRcdFx0XG5cdFx0XHRpZiAodmFsaWRhdGlvbnNBcnJheS5sZW5ndGgpIHtcblx0XHRcdFx0bGV0IHZhbGlkYXRpb25SZXN1bHQgPSB2YWxpZGF0ZShpbnB1dHNbaV0sIHZhbGlkYXRpb25zQXJyYXkpO1xuXHRcdFx0XHR2YWxpZGF0aW9uUmVzdWx0ID8gZXJyb3JNZXNzYWdlcyA9IHZhbGlkYXRpb25SZXN1bHQgOiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZXJyb3JNZXNzYWdlcy5sZW5ndGgpIHsgXG5cdFx0XHRcdHNob3dXYXJuaW5nKGlucHV0c1tpXSwgZXJyb3JNZXNzYWdlcywgdGV4dENvbG9yKTtcblx0XHRcdFx0ZXJyb3JzQ291bnRlcisrO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBlcnJvcnNDb3VudGVyID4gMCA/IGZhbHNlIDogdHJ1ZTtcblx0fVxuXG5cdC8vIC0tLS0tLS0tLS0tLS0tLVxuXHRyZXR1cm4ge1xuXHRcdGlzVmFsaWQ6IGlzVmFsaWQsXG5cdH1cbn0pKClcblxuLy8gLS0tLS0tLS0tVmFsaWRhdGlvbiBTY3JpcHQgVGVzdC0tLS0tLS0tLS0tLS1cblxuLy8gJCgnYm9keScpLm9uKCdjbGljaycsICdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScsIGZ1bmN0aW9uKGUpIHtcbi8vIFx0Ly8gY29uc29sZS5sb2coJ29rJylcbi8vIFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4vLyBcdC8vIFZhbGlkYXRpb25Nb2R1bGUuaXNWYWxpZCh0aGlzLmZvcm0pXG4vLyBcdGlmKCAhVmFsaWRhdGlvbk1vZHVsZS5pc1ZhbGlkKHRoaXMuZm9ybSkgKSB7XG4vLyBcdFx0Y29uc29sZS5sb2coJ2Zvcm0gbm90IHZhbGlkOiAnLCB0aGlzLmZvcm0pXG4vLyBcdH0gZWxzZSB7XG4vLyBcdFx0Y29uc29sZS5sb2coJ2Zvcm0gdmFsaWQ6ICcsIHRoaXMuZm9ybSlcbi8vIFx0fVxuLy8gfSkqL1xuXG5cblx0Ly8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5cdFxuXHRcdC8vIGNvbnNvbGUubG9nKCd3aW5kb3cgbG9hZCcpXG5cblx0Ly8gaWYgKCQoJ2JvZHknKSkge2NvbnNvbGUubG9nKCdqUXVlcnkgT0snKX1cblx0Ly8gY29uc29sZS5sb2codGVzdCk7XG5cblxuICAvLyAtLS0tLS0tLS1Qb3B1cHMgQmxvY2stLS0tLS0tXG5cblx0Ly8gJCgnYm9keScpLm9uKCdjbGljaycsICcub3JkZXJCdXR0b24nLCBmdW5jdGlvbigpIHtcbiAvLyAgXHQvLyBlLnByZXZlbnREZWZhdWx0KCk7XG4gLy8gIFx0aWYgKHBvcHVwT3JkZXIpIHtcbiAvLyAgXHRcdFBvcHVwTW9kdWxlLm9wZW5Qb3B1cChwb3B1cE9yZGVyKTtcbiAvLyAgXHR9XG4gLy8gIH0pO1xuXG4gIC8vIC0tLS0tLS0tLUFjY29yZGlvbiBCbG9ja3MtLS0tLS0tXG5cdC8vICQoJ2FjY29yZGlvbkJsb2NrU2VsZWN0b3InKS5vbignY2xpY2snLCAnLmJ1dHRvblNlbGVjdG9yJywgZnVuY3Rpb24oZSkge1xuXHQvLyBcdC8vIGNvbnNvbGUudGltZSgnY2xpY2sgYWNjb3JkaW9uIHdvcmtpbmcgdGltZScpO1xuXG5cdC8vIFx0aWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCA8IDk5Mikge1xuXHQvLyBcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0Ly8gXHRcdGxldCBzdWJtZW51QmxvY2sgPSB0aGlzLm5leHRFbGVtZW50U2libGluZztcblx0Ly8gXHRcdGxldCBidXR0b24gPSB0aGlzO1xuXG5cdC8vIFx0Ly8gbGV0IHNpYmxpbmdzQmxvY2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3B1YmxpY0luZm9QYWdlIGFydGljbGUucHVibGljSW5mby1ibG9jayAudGl0bGVCbG9jayArIC5oaWRkZW5Db250ZW50Jyk7XG5cblx0Ly8gXHRcdHRvZ2dsZUJ1dHRvbkNvbnRlbnQoYnV0dG9uKTtcblx0Ly8gXHRcdEFjY29yZGlvbk1vZHVsZS50b2dnbGVDb250ZW50KFwid2l0aG91dFNpYmxpbmdzXCIsIGJ1dHRvbiwgc3VibWVudUJsb2NrICk7XG5cdC8vIFx0XHQvLyBBY2NvcmRpb25Nb2R1bGUudG9nZ2xlQ29udGVudChcIndpdGhTaWJsaW5nc1wiLCBidXR0b24sIHN1Ym1lbnVCbG9jaywgc2libGluZ3NCbG9ja3MgKTtcdFx0XHRcdFxuXG5cdC8vIFx0fVxuXHQvLyBcdC8vIGNvbnNvbGUudGltZUVuZCgnY2xpY2sgYWNjb3JkaW9uIHdvcmtpbmcgdGltZScpO1xuXHQvLyB9KVxuXG4gIC8vIC0tLS0tLS0tLVRleHQgTGltaXQtLS0tLS0tXG5cdC8vIGxldCB0ZXh0QmxvY2tzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlbGVjdG9yJyk7XG5cdC8vIHRleHRCbG9ja3MubGVuZ3RoID8gVGV4dExpbWl0TW9kdWxlLnNsaWNlVGV4dCh0ZXh0QmxvY2tzLCAxODApIDogbnVsbDtcblx0XG5cblx0Ly8gLS0tLS0tLS0tLVNjcm9sbC10byBTZWN0aW9uLS0tLS0tLS0tLS0tLS0tXG5cdFxuXHQvLyAkKCdib2R5Jykub24oJ2NsaWNrJywgJ2FydGljbGUuc3RvcnktaXRlbScsIGZ1bmN0aW9uKCkge1xuXHRcdFxuXHQvLyBcdCQoJ2h0bWwsIGJvZHknKS5hbmltYXRlKHtcblx0Ly8gXHRcdHNjcm9sbFRvcDogJChcIiNcIiArICQodGhpcykuYXR0cignZGF0YS1zdG9yeS1pZCcpICkub2Zmc2V0KCkudG9wXG5cdC8vIFx0fSwgNTAwKTtcblx0Ly8gfSlcblxuXG5cblx0Ly8gPT09PT09PT09PT1Jbml0aWFsaXphdGlvbnM9PT09PT09PT09PT09XG5cblx0Ly8gQW5pbWF0ZUJvcmRlcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYW5pbWF0ZWQtYm9yZGVyLWJsb2NrIHN2ZycpLCB7XG5cdC8vIFx0Ym9yZGVyV2lkdGg6IDMsXG5cdC8vIFx0c2hhZGVkU2VjdGlvbjogMTAwLFxuXHQvLyBcdHRyYW5zcGFyZW50U2VjdGlvbjogMjUsXG5cdC8vIFx0cmV2ZXJzZTogZmFsc2UsXG5cdC8vIFx0cmFkaXVzOiB0cnVlIFxuXHQvLyB9KVxuXHRcblx0aWYgKHdpbmRvdy5pbm5lcldpZHRoIDwgNzY4KSB7XG5cdFx0KGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCEgalF1ZXJ5KCcubWFpbi1zbGlkZXItbW9iaWxlJykubGVuZ3RoKSByZXR1cm47XG5cblx0XHRcdGpRdWVyeSgnLm1haW4tc2xpZGVyLW1vYmlsZScpLnNsaWNrKHtcblx0XHRcdFx0YXJyb3dzOiBmYWxzZSxcblx0XHRcdFx0ZG90czogdHJ1ZSxcblx0XHRcdH0pO1xuXHRcdH0pKCk7XG5cdH1cblxuXHRpZiAod2luZG93LmlubmVyV2lkdGggPj0gNzY4KSB7XG5cdFx0KGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYoISBqUXVlcnkoJy5tYWluLXNsaWRlci1kZXNjdG9wJykubGVuZ3RoKSByZXR1cm47XG5cblx0XHRcdGxldCBzbGlkZXJEZXNjdG9wID0galF1ZXJ5KCcubWFpbi1zbGlkZXItZGVzY3RvcCcpO1xuXHRcdFx0bGV0IGNvdW50ZXIgPSAwO1x0XHRcdFxuXG5cdFx0XHRzbGlkZXJEZXNjdG9wLnNsaWNrKHtcblx0XHRcdFx0YXJyb3dzOiBmYWxzZSxcblx0XHRcdFx0ZG90czogdHJ1ZSxcblx0XHRcdFx0ZmFkZTogdHJ1ZSxcblx0XHRcdFx0c3BlZWQ6IDYwMCxcblx0XHRcdFx0YXV0b3BsYXk6IHRydWUsXG5cdFx0ICAgIGF1dG9wbGF5U3BlZWQ6IDQwMDAsXG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gYmVnaW4gY3VzdG9tIG51bWJlcnMgZG90c1xuXHRcdFx0bGV0IHNsaWRlckRvdHMgPSBqUXVlcnkoJy5zbGljay1kb3RzIGxpIGJ1dHRvbicpO1xuXHRcdFx0XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHNsaWRlckRvdHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0JChzbGlkZXJEb3RzW2ldKS50ZXh0KGkpO1x0XG5cdFx0XHR9XG5cdFx0XHRqUXVlcnkoJy5zbGljay1kb3RzIGxpOmZpcnN0LWNoaWxkJykuY3NzKCdkaXNwbGF5JywgJ25vbmUnKTtcblx0XHRcdC8vIGVuZCBjdXN0b20gbnVtYmVycyBkb3RzXG5cblx0XHRcdC8vIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBcdHNsaWRlckRlc2N0b3AuZmluZCgnLnNsaWRlci1kZXNjdG9wLWl0ZW06Zmlyc3QtY2hpbGQnKS5hZGRDbGFzcygnYW5pbWF0ZWQnKTtcdFx0XHRcdFxuXHRcdFx0Ly8gfSwgMTApO1xuXG5cdFx0XHRzbGlkZXJEZXNjdG9wLm9uKCdiZWZvcmVDaGFuZ2UnLCBmdW5jdGlvbihldmVudCwgc2xpY2ssIGN1cnJlbnRTbGlkZSkge1x0XG5cdFx0XHRcdGpRdWVyeShzbGlja1snJHNsaWRlcyddW2N1cnJlbnRTbGlkZV0pLnJlbW92ZUNsYXNzKCdhbmltYXRlZCcpO1x0XHRcdFx0XHRcblx0XHRcdH0pO1xuXG5cdFx0XHRzbGlkZXJEZXNjdG9wLm9uKCdhZnRlckNoYW5nZScsIGZ1bmN0aW9uKGV2ZW50LCBzbGljaywgY3VycmVudFNsaWRlKSB7XG5cdFx0XHRcdGpRdWVyeShzbGlja1snJHNsaWRlcyddW2N1cnJlbnRTbGlkZV0pLmFkZENsYXNzKCdhbmltYXRlZCcpO1x0XG5cblx0XHRcdFx0Y291bnRlcisrO1xuXHRcdFx0XHRpZihjb3VudGVyID09IHNsaWNrWyckc2xpZGVzJ10ubGVuZ3RoKSB7XG5cdFx0XHRcdFx0alF1ZXJ5KHRoaXMpLnNsaWNrKCdzbGlja1NldE9wdGlvbicsICdhdXRvcGxheScsIGZhbHNlKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9KTtcblxuXHRcdH0pKCk7XG5cdH1cblxufSk7XG5cblxuLy8gd2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuXHQvLyBjb25zb2xlLmxvZygnd2luZG93IGxvYWQnKVxuXHQvLyBqUXVlcnkoJyNwYWdlLXByZWxvYWRlcicpLmZhZGVPdXQoJ3Nsb3cnKTtcbi8vIH1cbiJdfQ==
